<div class="separator" style="clear: both;"><a href="https://cdn-icons-png.flaticon.com/128/16502/16502876.png" style="display: block; padding: 1em 0px; text-align: center;"><img alt="" border="0" data-original-height="128" data-original-width="128" src="https://cdn-icons-png.flaticon.com/128/16502/16502876.png" style="display: none;" width="200" /></a></div>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Time Table Generator VI-VIII</title><style>body{font-family:sans-serif;background:#f4f4f4;margin:0;padding:20px}h1{text-align:center;color:#333}table{width:100%;border-collapse:collapse;margin:20px 0;background:#fff}th,td{border:1px solid #ccc;padding:8px;text-align:center}th{background:#eaeaea}select,button{padding:5px;margin:5px}#controls{text-align:center;margin-bottom:10px}#timetable-container{overflow-x:auto}@media(max-width:600px){table{font-size:12px}}</style></head><body>
<h1><a>Auto Time Table Generator (Grade VIâ€“VIII)</a></h1>
<div id="controls">
  <label>Grade:
    <select id="grade"><option>VI</option><option>VII</option><option>VIII</option></select>
  </label>
  <label>Medium:
    <select id="medium"><option>Urdu</option><option>Sindhi</option><option>English</option></select>
  </label>
  <button onclick="generateTimeTable()">Generate Timetable</button>
  <button onclick="exportPDF()"><a href="">Export PDF</a></button>
  <button onclick="exportDOC()"><a href="">Export DOC</a></button>
</div>
<div id="timetable-container"></div>
<script>
const subjects=[{name:'Mathematics',periods:6},{name:'Urdu/Sindhi (L/S/R/W)',periods:6},{name:'English (L/S/R/W)',periods:6},{name:'Islamiat/Religious Studies',periods:4},{name:'General Science',periods:4},{name:'Social Studies',periods:4},{name:'Sales Urdu/Asan Sindhi (NMT)',periods:2},{name:'Computer Education',periods:2},{name:'Drawing/Home Eco/Agriculture',periods:2},{name:'Physical Education',periods:1},{name:'Library/Reading/Speaking',periods:1}];
const days=['Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
const periods=['8:20-9:00','9:00-9:40','9:40-10:20','10:20-11:00','11:30-12:10','12:10-12:50','12:50-1:30'];
function generateTimeTable(){
  let table='<table><tr><th>Days</th>';
  periods.forEach(p=>table+='<th>'+p+'</th>');
  table+='</tr>';
  let subAlloc={};subjects.forEach(s=>subAlloc[s.name]=s.periods);
  days.forEach(day=>{
    table+='<tr><th>'+day+'</th>';
    for(let i=0;i<7;i++){
      if(day==='Wednesday'&&i===3){table+='<td style="background:#fffae6">Break</td>';continue;}
      let available=Object.keys(subAlloc).filter(k=>subAlloc[k]>0);
      if(available.length===0){table+='<td>-</td>';continue;}
      let choice=available[Math.floor(Math.random()*available.length)];
      subAlloc[choice]--;table+='<td>'+choice+'</td>';
    }
    table+='</tr>';
  });
  table+='</table>';
  document.getElementById('timetable-container').innerHTML=table;
}
function exportPDF(){
  let printWin=window.open('','_blank');
  printWin.document.write('<html><head><title>Timetable</title></head><body>');
  printWin.document.write(document.getElementById('timetable-container').innerHTML);
  printWin.document.write('</body></html>');
  printWin.document.close();printWin.print();
}
function exportDOC(){
  const htmlContent=document.getElementById("timetable-container").innerHTML;
  const header="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Timetable</title></head><body>";
  const footer="</body></html>";
  const source=header+htmlContent+footer;
  const blob=new Blob(['\ufeff',source],{type:'application/msword'});
  const url='data:application/vnd.ms-word;charset=utf-8,'+encodeURIComponent(source);
  const link=document.createElement('a');
  link.href=url;link.download='TimeTable.doc';
  document.body.appendChild(link);link.click();document.body.removeChild(link);
}
</script>
</body></html>
