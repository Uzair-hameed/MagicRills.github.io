<div class="separator" style="clear: both;"><a href="https://cdn-icons-png.flaticon.com/128/1055/1055679.png" style="display: block; padding: 1em 0px; text-align: center;"><img alt="" border="0" data-original-height="128" data-original-width="128" src="https://cdn-icons-png.flaticon.com/128/1055/1055679.png" style="display: none;" width="200" /></a></div>

<html lang="en">
<head>
    <meta charset="UTF-8"></meta>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"></meta>
    <title> <a href="https://essentialmost.com/be3/V-0.PN3WplvsbFmLVpJuZLDy0/2yNOTfE_2/MQDJAc4TLpTYYP1/MpTrYEw/MADnkv">Performance Evaluation Report (PER) Generator</a> | MagicRills.com</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background-color: var(--primary-color);
            color: white;
            padding: 20px 0;
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 5px solid var(--secondary-color);
        }
        
        header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .form-container {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            padding: 30px;
            margin-bottom: 30px;
        }
        
        .form-section {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .form-section:last-child {
            border-bottom: none;
        }
        
        .form-section h2 {
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--secondary-color);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-color);
        }
        
        .form-control {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            transition: border 0.3s;
        }
        
        .form-control:focus {
            border-color: var(--secondary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .rating-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        .rating-table th, .rating-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        
        .rating-table th {
            background-color: var(--primary-color);
            color: white;
        }
        
        .rating-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .rating-table tr:hover {
            background-color: #f1f1f1;
        }
        
        .rating-options {
            display: flex;
            justify-content: space-between;
        }
        
        .rating-option {
            display: flex;
            align-items: center;
        }
        
        .rating-option input {
            margin-right: 8px;
        }
        
        .btn {
            display: inline-block;
            padding: 12px 24px;
            background-color: var(--secondary-color);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            text-align: center;
            transition: background-color 0.3s, transform 0.2s;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .btn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-primary {
            background-color: var(--secondary-color);
        }
        
        .btn-success {
            background-color: var(--success-color);
        }
        
        .btn-danger {
            background-color: var(--danger-color);
        }
        
        .btn-warning {
            background-color: var(--warning-color);
        }
        
        .action-buttons {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 30px;
        }
        
        .hidden {
            display: none;
        }
        
        .preview-container {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .preview-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .preview-header h2 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        
        .preview-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        .preview-table th, .preview-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        
        .preview-table th {
            background-color: var(--primary-color);
            color: white;
        }
        
        .grade-A {
            background-color: #d4edda;
            color: #155724;
        }
        
        .grade-B {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .grade-C {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .grade-D {
            background-color: #f8d7da;
            color: #721c24;
            font-weight: bold;
        }
        
        .signature-area {
            margin-top: 50px;
            display: flex;
            justify-content: space-between;
        }
        
        .signature-box {
            width: 45%;
            border-top: 1px solid #333;
            padding-top: 10px;
            margin-top: 60px;
        }
        
        .footer {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 8px;
        }
        
        @media print {
            .no-print {
                display: none;
            }
            
            body {
                background-color: white;
            }
            
            .container {
                padding: 0;
            }
            
            .form-container, .preview-container {
                box-shadow: none;
                border: none;
                padding: 0;
            }
        }
        
        @media (max-width: 768px) {
            .rating-options {
                flex-direction: column;
            }
            
            .rating-option {
                margin-bottom: 10px;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                margin-bottom: 10px;
                margin-right: 0;
            }
            
            .signature-area {
                flex-direction: column;
            }
            
            .signature-box {
                width: 100%;
                margin-bottom: 30px;
            }
        }
        
        /* Loading spinner */
        .spinner {
            display: none;
            width: 40px;
            height: 40px;
            margin: 0 auto;
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top: 4px solid var(--secondary-color);
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Alert messages */
        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
            font-weight: 600;
        }
        
        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-danger {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1> Performance Evaluation Report (PER) Generator</h1>
            <p>Government of Sindh - School Education &amp; Literacy Department</p>
        </div>
    </header>
    
    <div class="container">
        <div class="alert hidden" id="alert-message"></div>
        
        <div class="form-container no-print">
            <div class="form-section">
                <h2>Employee Information</h2>
                <div class="form-group">
                    <label for="fullName">Full Name (in block letters)</label>
                    <input class="form-control" id="fullName" required="" type="text" />
                </div>
                
                <div class="row">
                    <div class="form-group" style="float: left; width: 48%;">
                        <label for="cnic">CNIC #</label>
                        <input class="form-control" id="cnic" placeholder="XXXXX-XXXXXXX-X" required="" type="text" />
                    </div>
                    <div class="form-group" style="float: right; width: 48%;">
                        <label for="persNo">Pers #</label>
                        <input class="form-control" id="persNo" required="" type="text" />
                    </div>
                    <div style="clear: both;"></div>
                </div>
                
                <div class="form-group">
                    <label for="contactNo">Contact Number</label>
                    <input class="form-control" id="contactNo" required="" type="tel" />
                </div>
                
                <div class="row">
                    <div class="form-group" style="float: left; width: 32%;">
                        <label for="dob">Date of Birth</label>
                        <input class="form-control" id="dob" required="" type="date" />
                    </div>
                    <div class="form-group" style="float: left; margin-left: 2%; width: 32%;">
                        <label for="entryDate">Entry into Service</label>
                        <input class="form-control" id="entryDate" required="" type="date" />
                    </div>
                    <div class="form-group" style="float: right; width: 32%;">
                        <label for="presentPostDate">Since Present Post</label>
                        <input class="form-control" id="presentPostDate" required="" type="date" />
                    </div>
                    <div style="clear: both;"></div>
                </div>
                
                <div class="form-group">
                    <label for="designation">Designation with BPS</label>
                    <input class="form-control" id="designation" required="" type="text" />
                </div>
                
                <div class="form-group">
                    <label for="postHeld">Post held during the period</label>
                    <input class="form-control" id="postHeld" required="" type="text" />
                </div>
                
                <div class="form-group">
                    <label for="postingPlace">Place of Posting</label>
                    <input class="form-control" id="postingPlace" required="" type="text" />
                </div>
                
                <div class="row">
                    <div class="form-group" style="float: left; width: 48%;">
                        <label for="semisCode">SEMIS Code</label>
                        <input class="form-control" id="semisCode" type="text" />
                    </div>
                    <div class="form-group" style="float: right; width: 48%;">
                        <label for="qualification">Qualifications (last degree)</label>
                        <input class="form-control" id="qualification" required="" type="text" />
                    </div>
                    <div style="clear: both;"></div>
                </div>
                
                <div class="row">
                    <div class="form-group" style="float: left; width: 48%;">
                        <label for="evaluationPeriodFrom">Evaluation Period (From)</label>
                        <input class="form-control" id="evaluationPeriodFrom" required="" type="date" />
                    </div>
                    <div class="form-group" style="float: right; width: 48%;">
                        <label for="evaluationPeriodTo">Evaluation Period (To)</label>
                        <input class="form-control" id="evaluationPeriodTo" required="" type="date" />
                    </div>
                    <div style="clear: both;"></div>
                </div>
            </div>
            
            <div class="form-section">
                <h2>Performance Evaluation</h2>
                <table class="rating-table">
                    <thead>
                        <tr>
                            <th>S. No.</th>
                            <th>Indicator</th>
                            <th>A</th>
                            <th>B</th>
                            <th>C</th>
                            <th>D</th>
                            <th>Comments</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td colspan="7" style="background-color: #f0f0f0; font-weight: bold;">Standard 1: Individual Persona</td>
                        </tr>
                        <tr>
                            <td>1</td>
                            <td>Abides by Policies and Procedures Follows official policies, and procedures within school and classroom.</td>
                            <td><input name="rating1" required="" type="radio" value="A" /></td>
                            <td><input name="rating1" type="radio" value="B" /></td>
                            <td><input name="rating1" type="radio" value="C" /></td>
                            <td><input name="rating1" type="radio" value="D" /></td>
                            <td><input class="form-control" name="comment1" type="text" /></td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>Appearance and Conduct Dresses and behaves appropriately in school and classroom.</td>
                            <td><input name="rating2" required="" type="radio" value="A" /></td>
                            <td><input name="rating2" type="radio" value="B" /></td>
                            <td><input name="rating2" type="radio" value="C" /></td>
                            <td><input name="rating2" type="radio" value="D" /></td>
                            <td><input class="form-control" name="comment2" type="text" /></td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>Punctuality and Regularity Arrives and leaves school according to official timings. Conducts classes on time.</td>
                            <td><input name="rating3" required="" type="radio" value="A" /></td>
                            <td><input name="rating3" type="radio" value="B" /></td>
                            <td><input name="rating3" type="radio" value="C" /></td>
                            <td><input name="rating3" type="radio" value="D" /></td>
                            <td><input class="form-control" name="comment3" type="text" /></td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td>Communication and Collaboration Communicates and collaborates respectfully with school staff and students.</td>
                            <td><input name="rating4" required="" type="radio" value="A" /></td>
                            <td><input name="rating4" type="radio" value="B" /></td>
                            <td><input name="rating4" type="radio" value="C" /></td>
                            <td><input name="rating4" type="radio" value="D" /></td>
                            <td><input class="form-control" name="comment4" type="text" /></td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td>Healthy Interaction with Parents Promotes cooperation and communication between school and parents.</td>
                            <td><input name="rating5" required="" type="radio" value="A" /></td>
                            <td><input name="rating5" type="radio" value="B" /></td>
                            <td><input name="rating5" type="radio" value="C" /></td>
                            <td><input name="rating5" type="radio" value="D" /></td>
                            <td><input class="form-control" name="comment5" type="text" /></td>
                        </tr>
                        
                        <tr>
                            <td colspan="7" style="background-color: #f0f0f0; font-weight: bold;">Standard 2: Planning and Instruction</td>
                        </tr>
                        <tr>
                            <td>6</td>
                            <td>Content Mastery Demonstrates conceptual clarity across grades.</td>
                            <td><input name="rating6" required="" type="radio" value="A" /></td>
                            <td><input name="rating6" type="radio" value="B" /></td>
                            <td><input name="rating6" type="radio" value="C" /></td>
                            <td><input name="rating6" type="radio" value="D" /></td>
                            <td><input class="form-control" name="comment6" type="text" /></td>
                        </tr>
                        <tr>
                            <td>7</td>
                            <td>Lesson Planning Prepares daily lesson plans aligned with the given school curriculum.</td>
                            <td><input name="rating7" required="" type="radio" value="A" /></td>
                            <td><input name="rating7" type="radio" value="B" /></td>
                            <td><input name="rating7" type="radio" value="C" /></td>
                            <td><input name="rating7" type="radio" value="D" /></td>
                            <td><input class="form-control" name="comment7" type="text" /></td>
                        </tr>
                        <tr>
                            <td>8</td>
                            <td>Execution and Teaching Techniques Executes planned lesson using various teaching strategies.</td>
                            <td><input name="rating8" required="" type="radio" value="A" /></td>
                            <td><input name="rating8" type="radio" value="B" /></td>
                            <td><input name="rating8" type="radio" value="C" /></td>
                            <td><input name="rating8" type="radio" value="D" /></td>
                            <td><input class="form-control" name="comment8" type="text" /></td>
                        </tr>
                        <tr>
                            <td>9</td>
                            <td>Student-Centered Teaching Uses child-centered, activity-based learning methodology.</td>
                            <td><input name="rating9" required="" type="radio" value="A" /></td>
                            <td><input name="rating9" type="radio" value="B" /></td>
                            <td><input name="rating9" type="radio" value="C" /></td>
                            <td><input name="rating9" type="radio" value="D" /></td>
                            <td><input class="form-control" name="comment9" type="text" /></td>
                        </tr>
                        
                        <tr>
                            <td colspan="7" style="background-color: #f0f0f0; font-weight: bold;">Standard 3: Assessment</td>
                        </tr>
                        <tr>
                            <td>10</td>
                            <td>Conducts Regular and Grade-Appropriate Assessment Designs and conducts assessments at appropriate level.</td>
                            <td><input name="rating10" required="" type="radio" value="A" /></td>
                            <td><input name="rating10" type="radio" value="B" /></td>
                            <td><input name="rating10" type="radio" value="C" /></td>
                            <td><input name="rating10" type="radio" value="D" /></td>
                            <td><input class="form-control" name="comment10" type="text" /></td>
                        </tr>
                        <tr>
                            <td>11</td>
                            <td>Checks Note Book/Diary Regularly and accurately checks students' work.</td>
                            <td><input name="rating11" required="" type="radio" value="A" /></td>
                            <td><input name="rating11" type="radio" value="B" /></td>
                            <td><input name="rating11" type="radio" value="C" /></td>
                            <td><input name="rating11" type="radio" value="D" /></td>
                            <td><input class="form-control" name="comment11" type="text" /></td>
                        </tr>
                        <tr>
                            <td>12</td>
                            <td>Records Feedback Checks assessments correctly and provides timely feedback.</td>
                            <td><input name="rating12" required="" type="radio" value="A" /></td>
                            <td><input name="rating12" type="radio" value="B" /></td>
                            <td><input name="rating12" type="radio" value="C" /></td>
                            <td><input name="rating12" type="radio" value="D" /></td>
                            <td><input class="form-control" name="comment12" type="text" /></td>
                        </tr>
                        <tr>
                            <td>13</td>
                            <td>Improves through Review/Assessment Uses assessment results to improve teaching and learning.</td>
                            <td><input name="rating13" required="" type="radio" value="A" /></td>
                            <td><input name="rating13" type="radio" value="B" /></td>
                            <td><input name="rating13" type="radio" value="C" /></td>
                            <td><input name="rating13" type="radio" value="D" /></td>
                            <td><input class="form-control" name="comment13" type="text" /></td>
                        </tr>
                        
                        <tr>
                            <td colspan="7" style="background-color: #f0f0f0; font-weight: bold;">Standard 4: Classroom Management</td>
                        </tr>
                        <tr>
                            <td>14</td>
                            <td>Maintains Classroom Environment Keeps classroom space organized and clean, and manages time efficiently.</td>
                            <td><input name="rating14" required="" type="radio" value="A" /></td>
                            <td><input name="rating14" type="radio" value="B" /></td>
                            <td><input name="rating14" type="radio" value="C" /></td>
                            <td><input name="rating14" type="radio" value="D" /></td>
                            <td><input class="form-control" name="comment14" type="text" /></td>
                        </tr>
                        <tr>
                            <td>15</td>
                            <td>Maintains Discipline and Ethical Values Resolves disciplinary issues without hitting, harassment or abuse, and tries to nurture ethical values amongst students.</td>
                            <td><input name="rating15" required="" type="radio" value="A" /></td>
                            <td><input name="rating15" type="radio" value="B" /></td>
                            <td><input name="rating15" type="radio" value="C" /></td>
                            <td><input name="rating15" type="radio" value="D" /></td>
                            <td><input class="form-control" name="comment15" type="text" /></td>
                        </tr>
                        <tr>
                            <td>16</td>
                            <td>Maintains Positive Interaction in Class Shows respect and kindness towards all children.</td>
                            <td><input name="rating16" required="" type="radio" value="A" /></td>
                            <td><input name="rating16" type="radio" value="B" /></td>
                            <td><input name="rating16" type="radio" value="C" /></td>
                            <td><input name="rating16" type="radio" value="D" /></td>
                            <td><input class="form-control" name="comment16" type="text" /></td>
                        </tr>
                        <tr>
                            <td>17</td>
                            <td>Actively Listens to Students Listens and pays attention to students' needs and responses.</td>
                            <td><input name="rating17" required="" type="radio" value="A" /></td>
                            <td><input name="rating17" type="radio" value="B" /></td>
                            <td><input name="rating17" type="radio" value="C" /></td>
                            <td><input name="rating17" type="radio" value="D" /></td>
                            <td><input class="form-control" name="comment17" type="text" /></td>
                        </tr>
                        
                        <tr>
                            <td colspan="7" style="background-color: #f0f0f0; font-weight: bold;">Standard 5: Professional Outlook</td>
                        </tr>
                        <tr>
                            <td>18</td>
                            <td>Self-Development Researches and updates knowledge and improves practice.</td>
                            <td><input name="rating18" required="" type="radio" value="A" /></td>
                            <td><input name="rating18" type="radio" value="B" /></td>
                            <td><input name="rating18" type="radio" value="C" /></td>
                            <td><input name="rating18" type="radio" value="D" /></td>
                            <td><input class="form-control" name="comment18" type="text" /></td>
                        </tr>
                        <tr>
                            <td>19</td>
                            <td>Initiative and Drive Takes lead in organizing events, and co-curricular activities.</td>
                            <td><input name="rating19" required="" type="radio" value="A" /></td>
                            <td><input name="rating19" type="radio" value="B" /></td>
                            <td><input name="rating19" type="radio" value="C" /></td>
                            <td><input name="rating19" type="radio" value="D" /></td>
                            <td><input class="form-control" name="comment19" type="text" /></td>
                        </tr>
                        <tr>
                            <td>20</td>
                            <td>Uses Technology to Enhance Practice Uses available technology to communicate with students, parents and staff; prepare and deliver lessons; improve professional skills; and/or make routine tasks more efficient as relevant.</td>
                            <td><input name="rating20" required="" type="radio" value="A" /></td>
                            <td><input name="rating20" type="radio" value="B" /></td>
                            <td><input name="rating20" type="radio" value="C" /></td>
                            <td><input name="rating20" type="radio" value="D" /></td>
                            <td><input class="form-control" name="comment20" type="text" /></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="form-section">
                <h2>Student Results</h2>
                <div id="studentResultsContainer">
                    <div class="student-result-row">
                        <div class="row">
                            <div class="form-group" style="float: left; width: 32%;">
                                <label>Subject Taught</label>
                                <input class="form-control subject-taught" required="" type="text" />
                            </div>
                            <div class="form-group" style="float: left; margin-left: 2%; width: 18%;">
                                <label>Class</label>
                                <input class="form-control class" required="" type="text" />
                            </div>
                            <div class="form-group" style="float: left; margin-left: 2%; width: 18%;">
                                <label>Total Students</label>
                                <input class="form-control total-students" required="" type="number" />
                            </div>
                            <div class="form-group" style="float: left; margin-left: 2%; width: 18%;">
                                <label>Students Passing</label>
                                <input class="form-control students-passing" required="" type="number" />
                            </div>
                            <div class="form-group" style="float: right; text-align: center; width: 8%;">
                                <label>Action</label>
                                <button class="btn btn-danger remove-row" style="padding: 5px 10px;" type="button">×</button>
                            </div>
                            <div style="clear: both;"></div>
                        </div>
                    </div>
                </div>
                <button class="btn btn-secondary" id="addStudentResult" type="button"><>Add Another Subject</a></button>
            </div>
            
            <div class="form-section">
                <h2>Financial and Administrative Evaluation</h2>
                <div class="form-group">
                    <label for="financialEvaluation">Evaluation Details</label>
                    <textarea class="form-control" id="financialEvaluation" rows="4"></textarea>
                </div>
            </div>
            
            <div class="form-section">
                <h2>Overall Grading</h2>
                <div class="form-group">
                    <label for="overallGrading">Overall Grading</label>
                    <select class="form-control" id="overallGrading" required="">
                        <option value="">Select Grade</option>
                        <option value="A">A (Excellent)</option>
                        <option value="B">B (Good)</option>
                        <option value="C">C (Satisfactory)</option>
                        <option value="D">D (Needs Improvement)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="overallComments">Overall Comments</label>
                    <textarea class="form-control" id="overallComments" required="" rows="4"></textarea>
                </div>
            </div>
            
            <div class="form-section">
                <h2>Fitness for Promotion</h2>
                <div class="form-group">
                    <div class="rating-options">
                        <div class="rating-option">
                            <input id="fitForPromotion" name="fitnessForPromotion" required="" type="radio" value="Fit for promotion" />
                            <label for="fitForPromotion">Fit for promotion</label>
                        </div>
                        <div class="rating-option">
                            <input id="notFitForPromotion" name="fitnessForPromotion" type="radio" value="Not fit for promotion" />
                            <label for="notFitForPromotion">Not fit for promotion</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h2>Reporting Officer Details</h2>
                <div class="form-group">
                    <label for="reportingOfficerName">Name of Reporting Officer</label>
                    <input class="form-control" id="reportingOfficerName" required="" type="text" />
                </div>
                
                <div class="form-group">
                    <label for="reportingOfficerDesignation">Designation</label>
                    <input class="form-control" id="reportingOfficerDesignation" required="" type="text" />
                </div>
                
                <div class="form-group">
                    <label for="reportingDate">Date</label>
                    <input class="form-control" id="reportingDate" required="" type="date" />
                </div>
            </div>
            
            <div class="form-section">
                <h2>Countersigning Officer Remarks</h2>
                <div class="form-group">
                    <label for="assessmentQuality">Assessment Quality</label>
                    <select class="form-control" id="assessmentQuality">
                        <option value="">Select Assessment Quality</option>
                        <option value="very good">Very good</option>
                        <option value="reasonably good">Reasonably good</option>
                        <option value="strict">Strict</option>
                        <option value="lenient">Lenient</option>
                        <option value="biased">Biased</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="countersigningRemarks">Additional Remarks</label>
                    <textarea class="form-control" id="countersigningRemarks" rows="4"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="countersigningOfficerName">Name of Countersigning Officer</label>
                    <input class="form-control" id="countersigningOfficerName" type="text" />
                </div>
                
                <div class="form-group">
                    <label for="countersigningOfficerDesignation">Designation</label>
                    <input class="form-control" id="countersigningOfficerDesignation" type="text" />
                </div>
                
                <div class="form-group">
                    <label for="countersigningDate">Date</label>
                    <input class="form-control" id="countersigningDate" type="date" />
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="btn btn-primary" id="previewBtn" type="button"><a href="">Preview Evaluation</a></button>
                <button class="btn btn-danger" id="resetBtn" type="button">Reset Form</button>
            </div>
        </div>
        
        <div class="preview-container hidden" id="previewSection">
            <div class="preview-header">
                <h2>GOVERNMENT OF SINDH</h2>
                <h3>SCHOOL EDUCATION &amp; LITERACY DEPARTMENT</h3>
                <p>PERFORMANCE EVALUATION REPORT (PER)</p>
                <p id="previewPeriod">FOR THE PERIOD ______ TO ______</p>
            </div>
            
            <h3>PART I</h3>
            <table class="preview-table">
                <tr>
                    <td width="30%">1. Full Name (in block letters)</td>
                    <td id="previewFullName" width="70%">______</td>
                </tr>
                <tr>
                    <td>2. CNIC#</td>
                    <td id="previewCnic">______</td>
                </tr>
                <tr>
                    <td>3. Pers#</td>
                    <td id="previewPersNo">______</td>
                </tr>
                <tr>
                    <td>4. Contact no.</td>
                    <td id="previewContactNo">______</td>
                </tr>
                <tr>
                    <td>5. Date of:</td>
                    <td>
                        <div>(a) Birth: <span id="previewDob">______</span></div>
                        <div>(b) Entry into Service: <span id="previewEntryDate">______</span></div>
                        <div>(c) Since present post: <span id="previewPresentPostDate">______</span></div>
                    </td>
                </tr>
                <tr>
                    <td>6. Designation with BPS</td>
                    <td id="previewDesignation">______</td>
                </tr>
                <tr>
                    <td>7. Post held during the period</td>
                    <td id="previewPostHeld">______</td>
                </tr>
                <tr>
                    <td>8. Place of Posting</td>
                    <td id="previewPostingPlace">______</td>
                </tr>
                <tr>
                    <td>9. SEMIS Code</td>
                    <td id="previewSemisCode">______</td>
                </tr>
                <tr>
                    <td>10. Qualifications (last degree)</td>
                    <td id="previewQualification">______</td>
                </tr>
            </table>
            
            <h3>PART II</h3>
            <table class="preview-table">
                <thead>
                    <tr>
                        <th>S. No.</th>
                        <th>Indicator</th>
                        <th>Grade</th>
                        <th>Comments</th>
                    </tr>
                </thead>
                <tbody id="previewRatingsTable">
                    <!-- Ratings will be inserted here by JavaScript -->
                </tbody>
            </table>
            
            <h3>Student Results</h3>
            <table class="preview-table" id="previewStudentResults">
                <thead>
                    <tr>
                        <th>Subject Taught</th>
                        <th>Class</th>
                        <th>Total Number Of Students</th>
                        <th>No. Of Students Passing</th>
                        <th>Percentage Of Students Passing</th>
                        <th>Grade</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Student results will be inserted here by JavaScript -->
                </tbody>
            </table>
            
            <h3>Financial and Administrative Evaluation</h3>
            <div id="previewFinancialEvaluation" style="margin-bottom: 20px;">
                ______
            </div>
            
            <h3>Overall Grading</h3>
            <div id="previewOverallGrading" style="margin-bottom: 20px;">
                ______
            </div>
            
            <div id="previewOverallComments" style="margin-bottom: 20px;">
                ______
            </div>
            
            <h3>FITNESS FOR PROMOTION</h3>
            <div id="previewFitnessForPromotion" style="margin-bottom: 20px;">
                ______
            </div>
            
            <div class="signature-area">
                <div class="signature-box">
                    <div>Signature</div>
                    <div id="previewReportingOfficerName" style="margin-top: 20px;">______</div>
                    <div id="previewReportingDate">Date: ______</div>
                    <div id="previewReportingOfficerDesignation">Designation: ______</div>
                </div>
            </div>
            
            <h3>PART III - REMARKS OF THE COUNTERSIGNING OFFICER</h3>
            <div id="previewAssessmentQuality" style="margin-bottom: 10px;">
                I consider that the assessment made by the Reporting Officer is ______.
            </div>
            <div id="previewCountersigningRemarks" style="margin-bottom: 20px;">
                ______
            </div>
            
            <div class="signature-area">
                <div class="signature-box">
                    <div>Dated: <span id="previewCountersigningDate">______</span></div>
                    <div>Signature: <span id="previewCountersigningOfficerName">______</span></div>
                    <div>Designation: <span id="previewCountersigningOfficerDesignation">______</span></div>
                </div>
            </div>
            
            <div class="action-buttons no-print">
                <button class="btn btn-warning" id="backToFormBtn" type="button"><a href="">Back to Form</a></button>
                <button class="btn btn-primary" id="printBtn" type="button"><a href="">Print Evaluation</a></button>
                <button class="btn btn-success" id="pdfBtn" type="button"><a href="">Download PDF</a></button>
                <button class="btn btn-secondary" id="docBtn" type="button"><a href="">Download DOC</a></button>
                <div class="spinner hidden" id="spinner"></div>
            </div>
        </div>
        
        <div class="footer no-print">
            <p>Performance Evaluation Generator for Teaching Staff (BPS-09 to BPS-16)</p>
            <p>© 2023 MagicRills.com - All Rights Reserved</p>
        </div>
    </div>

    <!-- Load jsPDF and html2canvas from CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <script>
        // Wait for all scripts to load
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize jsPDF
            const { jsPDF } = window.jspdf;
            
            // Form elements
            const formContainer = document.querySelector('.form-container');
            const previewSection = document.getElementById('previewSection');
            const previewBtn = document.getElementById('previewBtn');
            const backToFormBtn = document.getElementById('backToFormBtn');
            const resetBtn = document.getElementById('resetBtn');
            const printBtn = document.getElementById('printBtn');
            const pdfBtn = document.getElementById('pdfBtn');
            const docBtn = document.getElementById('docBtn');
            const spinner = document.getElementById('spinner');
            const alertMessage = document.getElementById('alert-message');
            
            // Student results
            const studentResultsContainer = document.getElementById('studentResultsContainer');
            const addStudentResultBtn = document.getElementById('addStudentResult');
            
            // Add student result row
            addStudentResultBtn.addEventListener('click', function() {
                const newRow = document.createElement('div');
                newRow.className = 'student-result-row';
                newRow.innerHTML = `
                    <div class="row">
                        <div class="form-group" style="width: 32%; float: left;">
                            <label>Subject Taught</label>
                            <input type="text" class="form-control subject-taught" required>
                        </div>
                        <div class="form-group" style="width: 18%; float: left; margin-left: 2%;">
                            <label>Class</label>
                            <input type="text" class="form-control class" required>
                        </div>
                        <div class="form-group" style="width: 18%; float: left; margin-left: 2%;">
                            <label>Total Students</label>
                            <input type="number" class="form-control total-students" required>
                        </div>
                        <div class="form-group" style="width: 18%; float: left; margin-left: 2%;">
                            <label>Students Passing</label>
                            <input type="number" class="form-control students-passing" required>
                        </div>
                        <div class="form-group" style="width: 8%; float: right; text-align: center;">
                            <label>Action</label>
                            <button type="button" class="btn btn-danger remove-row" style="padding: 5px 10px;">×</button>
                        </div>
                        <div style="clear: both;"></div>
                    </div>
                `;
                studentResultsContainer.appendChild(newRow);
                
                // Add event listener to remove button
                newRow.querySelector('.remove-row').addEventListener('click', function() {
                    if (document.querySelectorAll('.student-result-row').length > 1) {
                        studentResultsContainer.removeChild(newRow);
                    } else {
                        showAlert('You must have at least one subject result.', 'danger');
                    }
                });
            });
            
            // Remove student result row (for initial row)
            document.querySelector('.remove-row')?.addEventListener('click', function() {
                if (document.querySelectorAll('.student-result-row').length > 1) {
                    studentResultsContainer.removeChild(this.closest('.student-result-row'));
                } else {
                    showAlert('You must have at least one subject result.', 'danger');
                }
            });
            
            // Preview button click handler
            previewBtn.addEventListener('click', function() {
                if (validateForm()) {
                    updatePreview();
                    formContainer.classList.add('hidden');
                    previewSection.classList.remove('hidden');
                    window.scrollTo(0, 0);
                }
            });
            
            // Back to form button click handler
            backToFormBtn.addEventListener('click', function() {
                formContainer.classList.remove('hidden');
                previewSection.classList.add('hidden');
                window.scrollTo(0, 0);
            });
            
            // Reset button click handler
            resetBtn.addEventListener('click', function() {
                if (confirm('Are you sure you want to reset the form? All entered data will be lost.')) {
                    document.querySelector('.form-container').reset();
                    
                    // Remove additional student result rows
                    const rows = document.querySelectorAll('.student-result-row');
                    for (let i = 1; i < rows.length; i++) {
                        studentResultsContainer.removeChild(rows[i]);
                    }
                    
                    // Reset the first row
                    const firstRow = rows[0];
                    firstRow.querySelector('.subject-taught').value = '';
                    firstRow.querySelector('.class').value = '';
                    firstRow.querySelector('.total-students').value = '';
                    firstRow.querySelector('.students-passing').value = '';
                    
                    showAlert('Form has been reset successfully.', 'success');
                }
            });
            
            // Print button click handler
            printBtn.addEventListener('click', function() {
                window.print();
            });
            
            // PDF button click handler
            pdfBtn.addEventListener('click', function() {
                generatePDF();
            });
            
            // DOC button click handler - Fixed version
            docBtn.addEventListener('click', function() {
                generateDOC();
            });
            
            // Validate form function
            function validateForm() {
                // Basic information validation
                const requiredFields = [
                    'fullName', 'cnic', 'persNo', 'contactNo', 'dob', 'entryDate', 
                    'presentPostDate', 'designation', 'postHeld', 'postingPlace', 
                    'qualification', 'evaluationPeriodFrom', 'evaluationPeriodTo',
                    'overallGrading', 'overallComments', 'reportingOfficerName',
                    'reportingOfficerDesignation', 'reportingDate'
                ];
                
                for (const fieldId of requiredFields) {
                    const field = document.getElementById(fieldId);
                    if (!field.value.trim()) {
                        showAlert(`Please fill in the ${field.labels ? field.labels[0].textContent : fieldId} field.`, 'danger');
                        field.focus();
                        return false;
                    }
                }
                
                // CNIC format validation (basic)
                const cnic = document.getElementById('cnic').value;
                if (!/^\d{5}-\d{7}-\d{1}$/.test(cnic)) {
                    showAlert('Please enter CNIC in correct format (XXXXX-XXXXXXX-X)', 'danger');
                    document.getElementById('cnic').focus();
                    return false;
                }
                
                // Rating validation
                for (let i = 1; i <= 20; i++) {
                    if (!document.querySelector(`input[name="rating${i}"]:checked`)) {
                        showAlert(`Please select a rating for indicator ${i}`, 'danger');
                        return false;
                    }
                }
                
                // Fitness for promotion validation
                if (!document.querySelector('input[name="fitnessForPromotion"]:checked')) {
                    showAlert('Please select fitness for promotion', 'danger');
                    return false;
                }
                
                // Student results validation
                const studentRows = document.querySelectorAll('.student-result-row');
                for (const row of studentRows) {
                    const subject = row.querySelector('.subject-taught').value;
                    const className = row.querySelector('.class').value;
                    const totalStudents = parseInt(row.querySelector('.total-students').value);
                    const studentsPassing = parseInt(row.querySelector('.students-passing').value);
                    
                    if (!subject || !className || !totalStudents || !studentsPassing) {
                        showAlert('Please fill in all student result fields for each subject', 'danger');
                        return false;
                    }
                    
                    if (parseInt(studentsPassing) > parseInt(totalStudents)) {
                        showAlert('Number of students passing cannot be greater than total students', 'danger');
                        return false;
                    }
                }
                
                return true;
            }
            
            // Update preview function
            function updatePreview() {
                // Part I: Employee Information
                document.getElementById('previewFullName').textContent = document.getElementById('fullName').value.toUpperCase();
                document.getElementById('previewCnic').textContent = document.getElementById('cnic').value;
                document.getElementById('previewPersNo').textContent = document.getElementById('persNo').value;
                document.getElementById('previewContactNo').textContent = document.getElementById('contactNo').value;
                document.getElementById('previewDob').textContent = formatDate(document.getElementById('dob').value);
                document.getElementById('previewEntryDate').textContent = formatDate(document.getElementById('entryDate').value);
                document.getElementById('previewPresentPostDate').textContent = formatDate(document.getElementById('presentPostDate').value);
                document.getElementById('previewDesignation').textContent = document.getElementById('designation').value;
                document.getElementById('previewPostHeld').textContent = document.getElementById('postHeld').value;
                document.getElementById('previewPostingPlace').textContent = document.getElementById('postingPlace').value;
                document.getElementById('previewSemisCode').textContent = document.getElementById('semisCode').value || '______';
                document.getElementById('previewQualification').textContent = document.getElementById('qualification').value;
                document.getElementById('previewPeriod').textContent = `FOR THE PERIOD ${formatDate(document.getElementById('evaluationPeriodFrom').value)} TO ${formatDate(document.getElementById('evaluationPeriodTo').value)}`;
                
                // Part II: Performance Evaluation
                const ratingsTable = document.getElementById('previewRatingsTable');
                ratingsTable.innerHTML = '';
                
                // Add standard headers and ratings
                const standards = [
                    { title: 'Standard 1: Individual Persona', start: 1, end: 5 },
                    { title: 'Standard 2: Planning and Instruction', start: 6, end: 9 },
                    { title: 'Standard 3: Assessment', start: 10, end: 13 },
                    { title: 'Standard 4: Classroom Management', start: 14, end: 17 },
                    { title: 'Standard 5: Professional Outlook', start: 18, end: 20 }
                ];
                
                for (const standard of standards) {
                    // Add standard header row
                    const headerRow = document.createElement('tr');
                    headerRow.innerHTML = `<td colspan="4" style="font-weight: bold; background-color: #f0f0f0;">${standard.title}</td>`;
                    ratingsTable.appendChild(headerRow);
                    
                    // Add rating rows for this standard
                    for (let i = standard.start; i <= standard.end; i++) {
                        const rating = document.querySelector(`input[name="rating${i}"]:checked`).value;
                        const comment = document.querySelector(`input[name="comment${i}"]`).value;
                        
                        const indicatorText = [
                            "Abides by Policies and Procedures Follows official policies, and procedures within school and classroom.",
                            "Appearance and Conduct Dresses and behaves appropriately in school and classroom.",
                            "Punctuality and Regularity Arrives and leaves school according to official timings. Conducts classes on time.",
                            "Communication and Collaboration Communicates and collaborates respectfully with school staff and students.",
                            "Healthy Interaction with Parents Promotes cooperation and communication between school and parents.",
                            "Content Mastery Demonstrates conceptual clarity across grades.",
                            "Lesson Planning Prepares daily lesson plans aligned with the given school curriculum.",
                            "Execution and Teaching Techniques Executes planned lesson using various teaching strategies.",
                            "Student-Centered Teaching Uses child-centered, activity-based learning methodology.",
                            "Conducts Regular and Grade-Appropriate Assessment Designs and conducts assessments at appropriate level.",
                            "Checks Note Book/Diary Regularly and accurately checks students' work.",
                            "Records Feedback Checks assessments correctly and provides timely feedback.",
                            "Improves through Review/Assessment Uses assessment results to improve teaching and learning.",
                            "Maintains Classroom Environment Keeps classroom space organized and clean, and manages time efficiently.",
                            "Maintains Discipline and Ethical Values Resolves disciplinary issues without hitting, harassment or abuse, and tries to nurture ethical values amongst students.",
                            "Maintains Positive Interaction in Class Shows respect and kindness towards all children.",
                            "Actively Listens to Students Listens and pays attention to students' needs and responses.",
                            "Self-Development Researches and updates knowledge and improves practice.",
                            "Initiative and Drive Takes lead in organizing events, and co-curricular activities.",
                            "Uses Technology to Enhance Practice Uses available technology to communicate with students, parents and staff; prepare and deliver lessons; improve professional skills; and/or make routine tasks more efficient as relevant."
                        ][i-1];
                        
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${i}</td>
                            <td>${indicatorText}</td>
                            <td>${rating}</td>
                            <td>${comment || '______'}</td>
                        `;
                        ratingsTable.appendChild(row);
                    }
                }
                
                // Student Results
                const studentResultsTable = document.querySelector('#previewStudentResults tbody');
                studentResultsTable.innerHTML = '';
                
                const studentRows = document.querySelectorAll('.student-result-row');
                for (const row of studentRows) {
                    const subject = row.querySelector('.subject-taught').value;
                    const className = row.querySelector('.class').value;
                    const totalStudents = parseInt(row.querySelector('.total-students').value);
                    const studentsPassing = parseInt(row.querySelector('.students-passing').value);
                    const percentage = Math.round((studentsPassing / totalStudents) * 100);
                    
                    let grade = '';
                    if (percentage > 70) grade = 'A';
                    else if (percentage >= 60) grade = 'B';
                    else if (percentage >= 50) grade = 'C';
                    else grade = 'D';
                    
                    const gradeClass = `grade-${grade}`;
                    
                    const resultRow = document.createElement('tr');
                    resultRow.innerHTML = `
                        <td>${subject}</td>
                        <td>${className}</td>
                        <td>${totalStudents}</td>
                        <td>${studentsPassing}</td>
                        <td>${percentage}%</td>
                        <td class="${gradeClass}">${grade}</td>
                    `;
                    studentResultsTable.appendChild(resultRow);
                }
                
                // Financial and Administrative Evaluation
                document.getElementById('previewFinancialEvaluation').textContent = 
                    document.getElementById('financialEvaluation').value || '______';
                
                // Overall Grading
                const overallGrade = document.getElementById('overallGrading').value;
                document.getElementById('previewOverallGrading').innerHTML = `
                    Overall Grading: <strong>${overallGrade}</strong>
                `;
                
                document.getElementById('previewOverallComments').textContent = 
                    document.getElementById('overallComments').value || '______';
                
                // Fitness for Promotion
                const fitness = document.querySelector('input[name="fitnessForPromotion"]:checked').value;
                document.getElementById('previewFitnessForPromotion').textContent = fitness;
                
                // Reporting Officer
                document.getElementById('previewReportingOfficerName').textContent = 
                    document.getElementById('reportingOfficerName').value;
                document.getElementById('previewReportingDate').textContent = 
                    `Date: ${formatDate(document.getElementById('reportingDate').value)}`;
                document.getElementById('previewReportingOfficerDesignation').textContent = 
                    `Designation: ${document.getElementById('reportingOfficerDesignation').value}`;
                
                // Countersigning Officer
                const assessmentQuality = document.getElementById('assessmentQuality').value;
                if (assessmentQuality) {
                    document.getElementById('previewAssessmentQuality').textContent = 
                        `I consider that the assessment made by the Reporting Officer is ${assessmentQuality}.`;
                } else {
                    document.getElementById('previewAssessmentQuality').textContent = 
                        'I consider that the assessment made by the Reporting Officer is ______.';
                }
                
                document.getElementById('previewCountersigningRemarks').textContent = 
                    document.getElementById('countersigningRemarks').value || '______';
                
                document.getElementById('previewCountersigningOfficerName').textContent = 
                    document.getElementById('countersigningOfficerName').value || '______';
                document.getElementById('previewCountersigningOfficerDesignation').textContent = 
                    document.getElementById('countersigningOfficerDesignation').value || '______';
                document.getElementById('previewCountersigningDate').textContent = 
                    document.getElementById('countersigningDate').value ? formatDate(document.getElementById('countersigningDate').value) : '______';
            }
            
            // Format date function
            function formatDate(dateString) {
                if (!dateString) return '______';
                
                const date = new Date(dateString);
                const day = date.getDate().toString().padStart(2, '0');
                const month = (date.getMonth() + 1).toString().padStart(2, '0');
                const year = date.getFullYear();
                
                return `${day}/${month}/${year}`;
            }
            
            // Show alert function
            function showAlert(message, type) {
                alertMessage.textContent = message;
                alertMessage.className = `alert alert-${type}`;
                alertMessage.classList.remove('hidden');
                
                // Hide alert after 5 seconds
                setTimeout(() => {
                    alertMessage.classList.add('hidden');
                }, 5000);
            }
            
            // Generate PDF function
            function generatePDF() {
                spinner.classList.remove('hidden');
                
                // Use html2canvas to capture the preview section
                html2canvas(previewSection, {
                    scale: 2,
                    logging: false,
                    useCORS: true,
                    allowTaint: true
                }).then(canvas => {
                    const imgData = canvas.toDataURL('image/png');
                    const pdf = new jsPDF({
                        orientation: 'portrait',
                        unit: 'mm'
                    });
                    
                    // Calculate the PDF dimensions to maintain aspect ratio
                    const imgWidth = 210; // A4 width in mm
                    const imgHeight = (canvas.height * imgWidth) / canvas.width;
                    
                    // Add the image to the PDF
                    pdf.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight);
                    
                    // Save the PDF
                    pdf.save(`Performance_Evaluation_${document.getElementById('fullName').value.replace(/\s+/g, '_')}.pdf`);
                    
                    spinner.classList.add('hidden');
                }).catch(error => {
                    console.error('Error generating PDF:', error);
                    showAlert('Error generating PDF. Please try again.', 'danger');
                    spinner.classList.add('hidden');
                });
            }
            
            // Generate DOC function - Fixed version
            function generateDOC() {
                spinner.classList.remove('hidden');
                
                try {
                    // Create a clone of the preview section to avoid modifying the original
                    const previewClone = previewSection.cloneNode(true);
                    
                    // Remove action buttons from the clone
                    const actionButtons = previewClone.querySelector('.action-buttons');
                    if (actionButtons) {
                        actionButtons.remove();
                    }
                    
                    // Get the HTML content
                    const htmlContent = `
                        <!DOCTYPE html>
                        <html>
                        <head>
                            <meta charset="UTF-8">
                            <title>Performance Evaluation Report</title>
                            <style>
                                body { font-family: Arial, sans-serif; margin: 20px; }
                                table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }
                                th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                                th { background-color: #2c3e50; color: white; }
                                .grade-A { background-color: #d4edda; color: #155724; }
                                .grade-B { background-color: #fff3cd; color: #856404; }
                                .grade-C, .grade-D { background-color: #f8d7da; color: #721c24; }
                                .signature-box { width: 45%; border-top: 1px solid #333; padding-top: 10px; margin-top: 60px; }
                                h2, h3 { color: #2c3e50; }
                                .preview-header { text-align: center; margin-bottom: 30px; }
                            </style>
                        </head>
                        <body>
                            ${previewClone.innerHTML}
                        </body>
                        </html>
                    `;
                    
                    // Create a Blob with the HTML content
                    const blob = new Blob([htmlContent], { type: 'application/msword' });
                    
                    // Create a download link
                    const link = document.createElement('a');
                    const url = URL.createObjectURL(blob);
                    link.href = url;
                    link.download = `Performance_Evaluation_${document.getElementById('fullName').value.replace(/\s+/g, '_')}.doc`;
                    
                    // Append the link to the body and trigger the download
                    document.body.appendChild(link);
                    link.click();
                    
                    // Clean up
                    setTimeout(() => {
                        document.body.removeChild(link);
                        URL.revokeObjectURL(url);
                        spinner.classList.add('hidden');
                    }, 100);
                    
                } catch (error) {
                    console.error('Error generating DOC:', error);
                    showAlert('Error generating DOC. Please try again.', 'danger');
                    spinner.classList.add('hidden');
                }
            }
        });
    </script>
</body>
</html>