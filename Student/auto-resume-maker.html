<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto Resume Maker Tool</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.8.2/docx.min.js"></script>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2980b9;
            --text-color: #333;
            --bg-color: #f9f9f9;
            --resume-bg: #ffffff;
            --header-color: #2c3e50;
            --accent-color: #e74c3c;
        }

        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--bg-color);
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background-color: var(--primary-color);
            color: white;
            padding: 20px 0;
            text-align: center;
            margin-bottom: 30px;
            border-radius: 5px;
        }

        h1 {
            margin: 0;
            font-size: 2.5rem;
        }

        .tool-description {
            font-size: 1.1rem;
            margin-top: 10px;
        }

        .resume-maker {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .editor-panel {
            flex: 1;
            min-width: 300px;
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .preview-panel {
            flex: 1;
            min-width: 300px;
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
        }

        .resume-preview {
            background-color: var(--resume-bg);
            border: 1px solid #ddd;
            min-height: 800px;
            padding: 20px;
            margin-bottom: 20px;
            overflow: auto;
            position: relative;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        input[type="text"],
        input[type="email"],
        input[type="tel"],
        textarea,
        select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: inherit;
        }

        textarea {
            min-height: 80px;
            resize: vertical;
        }

        .section {
            margin-bottom: 25px;
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
        }

        .section-title {
            font-size: 1.3rem;
            color: var(--primary-color);
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background-color 0.3s;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn:hover {
            background-color: var(--secondary-color);
        }

        .btn-secondary {
            background-color: #95a5a6;
        }

        .btn-secondary:hover {
            background-color: #7f8c8d;
        }

        .btn-danger {
            background-color: #e74c3c;
        }

        .btn-danger:hover {
            background-color: #c0392b;
        }

        .btn-small {
            padding: 5px 10px;
            font-size: 0.8rem;
        }

        .add-item-btn {
            margin-top: 10px;
        }

        .item-list {
            margin-top: 10px;
        }

        .item {
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 10px;
            position: relative;
        }

        .remove-item {
            position: absolute;
            top: 5px;
            right: 5px;
            background: none;
            border: none;
            color: #e74c3c;
            cursor: pointer;
            font-size: 1rem;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .action-buttons .btn {
            flex: 1;
            min-width: 150px;
        }

        .theme-options {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .theme-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .theme-option.selected {
            border-color: #333;
        }

        .font-options {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .font-option {
            padding: 5px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
        }

        .font-option.selected {
            background-color: var(--primary-color);
            color: white;
        }

        /* Resume Preview Styles */
        .resume-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--primary-color);
        }

        .resume-name {
            font-size: 2rem;
            margin: 0;
            color: var(--header-color);
            text-transform: uppercase;
        }

        .resume-title {
            font-size: 1.2rem;
            margin: 5px 0;
            color: var(--primary-color);
        }

        .resume-contact {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .resume-section {
            margin-bottom: 20px;
        }

        .resume-section-title {
            font-size: 1.3rem;
            color: var(--primary-color);
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
            margin-bottom: 10px;
        }

        .resume-item {
            margin-bottom: 15px;
        }

        .resume-item-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .resume-item-title {
            font-weight: bold;
            font-size: 1.1rem;
        }

        .resume-item-date {
            color: #666;
        }

        .resume-item-subtitle {
            font-style: italic;
            color: #666;
            margin-bottom: 5px;
        }

        .resume-skills {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .skill-tag {
            background-color: var(--primary-color);
            color: white;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.9rem;
        }

        .profile-image-container {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            overflow: hidden;
            margin: 0 auto 15px;
            border: 3px solid var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f0f0f0;
        }

        .profile-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .upload-btn-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
            text-align: center;
        }

        .upload-btn {
            border: 2px dashed #ccc;
            color: #666;
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            font-size: 1rem;
            width: 100%;
            cursor: pointer;
        }

        .upload-btn:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .upload-btn-wrapper input[type=file] {
            font-size: 100px;
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .color-picker {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .color-input {
            width: 50px;
            height: 30px;
            padding: 0;
            border: 1px solid #ddd;
        }

        .loading {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .loading-content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            text-align: center;
        }

        .spinner {
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--primary-color);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 20px;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
        }

        .tab.active {
            border-bottom-color: var(--primary-color);
            font-weight: bold;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .social-links {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .social-link {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .social-icon {
            width: 20px;
            height: 20px;
        }

        .resume-social {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 10px;
        }

        .resume-social a {
            color: var(--primary-color);
            text-decoration: none;
        }

        .resume-social a:hover {
            text-decoration: underline;
        }

        .template-options {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .template-option {
            flex: 1;
            min-width: 100px;
            border: 2px solid #ddd;
            border-radius: 5px;
            padding: 10px;
            cursor: pointer;
            text-align: center;
        }

        .template-option.selected {
            border-color: var(--primary-color);
            background-color: rgba(52, 152, 219, 0.1);
        }

        .template-preview {
            height: 150px;
            background-color: #f5f5f5;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 3px;
        }

        .template-name {
            font-weight: bold;
        }

        .language-selector {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .language-option {
            padding: 5px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
        }

        .language-option.selected {
            background-color: var(--primary-color);
            color: white;
        }

        .auto-save-status {
            font-size: 0.8rem;
            color: #666;
            margin-top: 5px;
        }

        @media (max-width: 768px) {
            .resume-maker {
                flex-direction: column;
            }
            
            .action-buttons .btn {
                min-width: 120px;
            }
        }

        /* Themes */
        .theme-default {
            --primary-color: #3498db;
            --secondary-color: #2980b9;
            --text-color: #333;
            --bg-color: #f9f9f9;
            --resume-bg: #ffffff;
            --header-color: #2c3e50;
            --accent-color: #e74c3c;
        }

        .theme-professional {
            --primary-color: #2c3e50;
            --secondary-color: #1a252f;
            --text-color: #333;
            --bg-color: #ecf0f1;
            --resume-bg: #ffffff;
            --header-color: #2c3e50;
            --accent-color: #e74c3c;
        }

        .theme-modern {
            --primary-color: #9b59b6;
            --secondary-color: #8e44ad;
            --text-color: #333;
            --bg-color: #f5eef8;
            --resume-bg: #ffffff;
            --header-color: #2c3e50;
            --accent-color: #e74c3c;
        }

        .theme-creative {
            --primary-color: #e67e22;
            --secondary-color: #d35400;
            --text-color: #333;
            --bg-color: #fef5e7;
            --resume-bg: #ffffff;
            --header-color: #e67e22;
            --accent-color: #3498db;
        }

        .theme-minimal {
            --primary-color: #95a5a6;
            --secondary-color: #7f8c8d;
            --text-color: #333;
            --bg-color: #f9f9f9;
            --resume-bg: #ffffff;
            --header-color: #333;
            --accent-color: #333;
        }

        /* Font classes */
        .font-arial {
            font-family: Arial, sans-serif;
        }

        .font-times {
            font-family: "Times New Roman", serif;
        }

        .font-georgia {
            font-family: Georgia, serif;
        }

        .font-verdana {
            font-family: Verdana, sans-serif;
        }

        .font-courier {
            font-family: "Courier New", monospace;
        }

        .font-helvetica {
            font-family: "Helvetica Neue", sans-serif;
        }

        /* Template-specific styles */
        .template-standard .resume-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--primary-color);
        }

        .template-classic .resume-header {
            text-align: left;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .template-classic .profile-image-container {
            margin: 0;
            width: 100px;
            height: 100px;
        }

        .template-classic .resume-name {
            font-size: 1.8rem;
        }

        .template-modern .resume-header {
            background-color: var(--primary-color);
            color: white;
            padding: 30px;
            margin: -20px -20px 20px -20px;
            border-radius: 5px 5px 0 0;
        }

        .template-modern .resume-name,
        .template-modern .resume-title,
        .template-modern .resume-contact {
            color: white;
        }

        .template-modern .resume-section-title {
            border-bottom: 2px solid var(--primary-color);
        }

        .template-creative .resume-header {
            border-bottom: none;
            position: relative;
        }

        .template-creative .resume-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background-color: var(--primary-color);
        }

        .template-creative .resume-section-title {
            border-bottom: none;
            position: relative;
            padding-left: 15px;
        }

        .template-creative .resume-section-title::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 5px;
            height: 20px;
            background-color: var(--primary-color);
        }

        /* New template styles */
        .template-executive .resume-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            text-align: left;
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 20px;
        }

        .template-executive .profile-image-container {
            margin: 0;
            width: 120px;
            height: 120px;
        }

        .template-executive .resume-name {
            font-size: 2.2rem;
            margin-bottom: 5px;
        }

        .template-executive .resume-title {
            font-size: 1.3rem;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .template-executive .resume-contact {
            justify-content: flex-start;
            margin-top: 0;
        }

        .template-executive .resume-section {
            display: flex;
            margin-bottom: 25px;
        }

        .template-executive .resume-section-title {
            flex: 0 0 200px;
            font-size: 1.2rem;
            color: var(--primary-color);
            border-bottom: none;
            margin-bottom: 0;
            padding-right: 20px;
        }

        .template-executive .resume-section-content {
            flex: 1;
            border-left: 2px solid var(--primary-color);
            padding-left: 20px;
        }

        .template-executive .resume-item {
            margin-bottom: 20px;
        }

        .template-minimalist .resume-header {
            text-align: center;
            border-bottom: none;
            padding-bottom: 10px;
            margin-bottom: 10px;
        }

        .template-minimalist .resume-name {
            font-size: 1.8rem;
            font-weight: 300;
            letter-spacing: 2px;
        }

        .template-minimalist .resume-title {
            font-size: 1rem;
            color: #666;
            font-weight: 300;
            margin-bottom: 10px;
        }

        .template-minimalist .resume-contact {
            font-size: 0.9rem;
            color: #666;
        }

        .template-minimalist .resume-section {
            margin-bottom: 15px;
        }

        .template-minimalist .resume-section-title {
            font-size: 1rem;
            color: #333;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .template-minimalist .resume-item {
            margin-bottom: 10px;
        }

        .template-minimalist .resume-item-header {
            margin-bottom: 3px;
        }

        .template-minimalist .resume-item-title {
            font-size: 1rem;
        }

        .template-minimalist .resume-item-date {
            font-size: 0.9rem;
        }

        .template-minimalist .resume-item-subtitle {
            font-size: 0.9rem;
            margin-bottom: 3px;
        }

        .template-minimalist .resume-skills .skill-tag {
            background-color: transparent;
            color: #333;
            border: 1px solid #ddd;
            padding: 2px 8px;
            font-size: 0.8rem;
        }

        .template-two-column .resume-preview {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
        }

        .template-two-column .resume-sidebar {
            background-color: var(--primary-color);
            color: white;
            padding: 20px;
            margin: -20px 0 -20px -20px;
            border-radius: 5px 0 0 5px;
        }

        .template-two-column .resume-sidebar .resume-section-title {
            color: white;
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
        }

        .template-two-column .resume-main {
            padding-right: 20px;
        }

        .template-two-column .profile-image-container {
            width: 150px;
            height: 150px;
            margin: 0 auto 20px;
        }

        .template-two-column .resume-name {
            font-size: 1.8rem;
            text-align: center;
            margin-bottom: 10px;
        }

        .template-two-column .resume-title {
            text-align: center;
            margin-bottom: 20px;
        }

        .template-two-column .resume-contact {
            flex-direction: column;
            align-items: flex-start;
            gap: 5px;
            margin-top: 0;
        }

        .template-two-column .resume-skills .skill-tag {
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
        }

        /* Print styles */
        @media print {
            body * {
                visibility: hidden;
            }
            .resume-preview, .resume-preview * {
                visibility: visible;
            }
            .resume-preview {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                box-shadow: none;
                border: none;
            }
            .action-buttons, .editor-panel, header {
                display: none !important;
            }
        }
    </style>
</head>
<body class="theme-default font-arial">
    <div class="container">
        <header>
            <h1>Auto Resume Maker Tool</h1>
            <p class="tool-description">Create professional resumes in minutes with our easy-to-use tool</p>
        </header>

        <div class="resume-maker">
            <div class="editor-panel">
                <div class="tabs">
                    <div class="tab active" data-tab="personal">Personal Info</div>
                    <div class="tab" data-tab="experience">Experience</div>
                    <div class="tab" data-tab="education">Education</div>
                    <div class="tab" data-tab="skills">Skills</div>
                    <div class="tab" data-tab="customization">Customization</div>
                </div>

                <div class="tab-content active" id="personal-tab">
                    <div class="section">
                        <h2 class="section-title">Personal Information</h2>
                        <div class="form-group">
                            <label for="full-name">Full Name</label>
                            <input id="full-name" placeholder="John Doe" type="text" />
                        </div>
                        <div class="form-group">
                            <label for="job-title">Professional Title</label>
                            <input id="job-title" placeholder="Web Developer" type="text" />
                        </div>
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input id="email" placeholder="john@example.com" type="email" />
                        </div>
                        <div class="form-group">
                            <label for="phone">Phone</label>
                            <input id="phone" placeholder="(123) 456-7890" type="tel" />
                        </div>
                        <div class="form-group">
                            <label for="address">Address</label>
                            <input id="address" placeholder="City, Country" type="text" />
                        </div>
                        <div class="form-group">
                            <label for="summary">Professional Summary</label>
                            <textarea id="summary" placeholder="A brief summary of your professional background and skills"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Profile Image</label>
                            <div class="upload-btn-wrapper">
                                <button class="upload-btn">Upload Profile Image</button>
                                <input accept="image/*" id="profile-image" type="file" />
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Social Links</label>
                            <div class="social-links" id="social-links">
                                <!-- Social links will be added here -->
                            </div>
                            <button class="btn btn-secondary add-item-btn" id="add-social">Add Social Link</button>
                        </div>
                    </div>
                </div>

                <div class="tab-content" id="experience-tab">
                    <div class="section">
                        <h2 class="section-title">Work Experience</h2>
                        <div class="item-list" id="experience-items">
                            <!-- Experience items will be added here -->
                        </div>
                        <button class="btn btn-secondary add-item-btn" id="add-experience">Add Experience</button>
                    </div>
                </div>

                <div class="tab-content" id="education-tab">
                    <div class="section">
                        <h2 class="section-title">Education</h2>
                        <div class="item-list" id="education-items">
                            <!-- Education items will be added here -->
                        </div>
                        <button class="btn btn-secondary add-item-btn" id="add-education">Add Education</button>
                    </div>
                </div>

                <div class="tab-content" id="skills-tab">
                    <div class="section">
                        <h2 class="section-title">Skills</h2>
                        <div class="item-list" id="skill-items">
                            <!-- Skill items will be added here -->
                        </div>
                        <button class="btn btn-secondary add-item-btn" id="add-skill">Add Skill</button>
                    </div>
                </div>

                <div class="tab-content" id="customization-tab">
                    <div class="section">
                        <h2 class="section-title">Template</h2>
                        <div class="template-options">
                            <div class="template-option selected" data-template="template-standard">
                                <div class="template-preview">
                                    <div style="text-align: center;">
                                        <div style="width: 80%; height: 10px; background: var(--primary-color); margin: 5px auto;"></div>
                                        <div style="width: 60%; height: 8px; background: #ddd; margin: 5px auto;"></div>
                                        <div style="width: 70%; height: 8px; background: #ddd; margin: 5px auto;"></div>
                                    </div>
                                </div>
                                <div class="template-name">Standard</div>
                            </div>
                            <div class="template-option" data-template="template-classic">
                                <div class="template-preview">
                                    <div style="display: flex; gap: 10px; width: 100%; padding: 10px;">
                                        <div style="width: 30px; height: 30px; background: var(--primary-color); border-radius: 50%;"></div>
                                        <div style="flex: 1;">
                                            <div style="width: 80%; height: 10px; background: var(--primary-color); margin-bottom: 5px;"></div>
                                            <div style="width: 60%; height: 8px; background: #ddd;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="template-name">Classic</div>
                            </div>
                            <div class="template-option" data-template="template-modern">
                                <div class="template-preview">
                                    <div style="background: var(--primary-color); height: 30px; border-radius: 3px 3px 0 0;"></div>
                                    <div style="padding: 10px;">
                                        <div style="width: 80%; height: 10px; background: white; margin: 5px auto;"></div>
                                        <div style="width: 60%; height: 8px; background: rgba(255,255,255,0.7); margin: 5px auto;"></div>
                                    </div>
                                </div>
                                <div class="template-name">Modern</div>
                            </div>
                            <div class="template-option" data-template="template-creative">
                                <div class="template-preview">
                                    <div style="text-align: center; padding: 10px;">
                                        <div style="width: 80%; height: 10px; background: var(--primary-color); margin: 5px auto;"></div>
                                        <div style="width: 60%; height: 8px; background: #ddd; margin: 5px auto; position: relative;">
                                            <div style="position: absolute; left: -5px; top: 0; width: 3px; height: 100%; background: var(--primary-color);"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="template-name">Creative</div>
                            </div>
                            <div class="template-option" data-template="template-executive">
                                <div class="template-preview">
                                    <div style="display: flex; gap: 10px; width: 100%; padding: 10px;">
                                        <div style="width: 40px; height: 40px; background: var(--primary-color); border-radius: 50%;"></div>
                                        <div style="flex: 1;">
                                            <div style="width: 80%; height: 12px; background: var(--primary-color); margin-bottom: 5px;"></div>
                                            <div style="width: 60%; height: 8px; background: #ddd; margin-bottom: 5px;"></div>
                                            <div style="display: flex; gap: 5px;">
                                                <div style="width: 20%; height: 6px; background: #ddd;"></div>
                                                <div style="width: 20%; height: 6px; background: #ddd;"></div>
                                                <div style="width: 20%; height: 6px; background: #ddd;"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="template-name">Executive</div>
                            </div>
                            <div class="template-option" data-template="template-minimalist">
                                <div class="template-preview">
                                    <div style="text-align: center; padding: 10px;">
                                        <div style="width: 70%; height: 10px; background: #333; margin: 5px auto;"></div>
                                        <div style="width: 50%; height: 6px; background: #666; margin: 5px auto;"></div>
                                        <div style="width: 60%; height: 6px; background: #ddd; margin: 5px auto;"></div>
                                    </div>
                                </div>
                                <div class="template-name">Minimalist</div>
                            </div>
                            <div class="template-option" data-template="template-two-column">
                                <div class="template-preview">
                                    <div style="display: flex; height: 100%;">
                                        <div style="width: 30%; background: var(--primary-color); padding: 10px;">
                                            <div style="width: 80%; height: 10px; background: white; margin: 5px auto;"></div>
                                            <div style="width: 60%; height: 8px; background: rgba(255,255,255,0.7); margin: 5px auto;"></div>
                                        </div>
                                        <div style="width: 70%; padding: 10px;">
                                            <div style="width: 90%; height: 10px; background: var(--primary-color); margin-bottom: 5px;"></div>
                                            <div style="width: 80%; height: 8px; background: #ddd; margin-bottom: 5px;"></div>
                                            <div style="width: 70%; height: 8px; background: #ddd;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="template-name">Two Column</div>
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <h2 class="section-title">Customization</h2>
                        <div class="form-group">
                            <label>Theme</label>
                            <div class="theme-options">
                                <div class="theme-option selected" data-theme="theme-default" style="background-color: #3498db;" title="Default"></div>
                                <div class="theme-option" data-theme="theme-professional" style="background-color: #2c3e50;" title="Professional"></div>
                                <div class="theme-option" data-theme="theme-modern" style="background-color: #9b59b6;" title="Modern"></div>
                                <div class="theme-option" data-theme="theme-creative" style="background-color: #e67e22;" title="Creative"></div>
                                <div class="theme-option" data-theme="theme-minimal" style="background-color: #95a5a6;" title="Minimal"></div>
                                <div class="theme-option" style="background-color: white; border: 1px solid #ddd;" title="Custom">
                                    <div style="background: conic-gradient(red, yellow, lime, aqua, blue, magenta, red); height: 100%; width: 100%; border-radius: 50%;"></div>
                                </div>
                            </div>
                            <div class="color-picker" id="custom-color-picker" style="display: none; margin-top: 10px;">
                                <div>
                                    <label for="primary-color">Primary Color</label>
                                    <input class="color-input" id="primary-color" type="color" value="#3498db" />
                                </div>
                                <div>
                                    <label for="secondary-color">Secondary Color</label>
                                    <input class="color-input" id="secondary-color" type="color" value="#2980b9" />
                                </div>
                                <div>
                                    <label for="header-color">Header Color</label>
                                    <input class="color-input" id="header-color" type="color" value="#2c3e50" />
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Font</label>
                            <div class="font-options">
                                <div class="font-option selected" data-font="font-arial">Arial</div>
                                <div class="font-option" data-font="font-times">Times New Roman</div>
                                <div class="font-option" data-font="font-georgia">Georgia</div>
                                <div class="font-option" data-font="font-verdana">Verdana</div>
                                <div class="font-option" data-font="font-courier">Courier New</div>
                                <div class="font-option" data-font="font-helvetica">Helvetica</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn" id="preview-btn">Preview Resume</button>
                    <button class="btn" id="download-pdf">Download PDF</button>
                    <button class="btn" id="download-doc">Download DOC</button>
                    <button class="btn btn-secondary" id="print-btn">Print Resume</button>
                    <button class="btn btn-secondary" id="reset-btn">Reset Form</button>
                </div>
                <div class="auto-save-status" id="auto-save-status">Auto-saved</div>
            </div>

            <div class="preview-panel">
                <h2>Resume Preview</h2>
                <div class="resume-preview template-standard" id="resume-preview">
                    <!-- Resume preview will be generated here -->
                </div>
                <div class="action-buttons">
                    <button class="btn" id="refresh-preview">Refresh Preview</button>
                </div>
            </div>
        </div>
    </div>

    <div class="loading" id="loading">
        <div class="loading-content">
            <div class="spinner"></div>
            <p>Generating your resume...</p>
        </div>
    </div>

    <script>
        // Resume data structure
        const resumeData = {
            personal: {
                name: "",
                title: "",
                email: "",
                phone: "",
                address: "",
                summary: "",
                image: "",
                social: []
            },
            experience: [],
            education: [],
            skills: [],
            settings: {
                theme: "theme-default",
                font: "font-arial",
                template: "template-standard"
            }
        };

        // DOM elements
        const resumePreview = document.getElementById('resume-preview');
        const loadingElement = document.getElementById('loading');
        const autoSaveStatus = document.getElementById('auto-save-status');

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeTabs();
            initializeForm();
            initializeCustomization();
            initializeActionButtons();
            loadFromLocalStorage();
            generatePreview();
            
            // Auto-save every 10 seconds
            setInterval(saveToLocalStorage, 10000);
        });

        // Tab functionality
        function initializeTabs() {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // Remove active class from all tabs and contents
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    // Add active class to current tab and content
                    this.classList.add('active');
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
        }

        // Form initialization
        function initializeForm() {
            // Personal info form elements
            document.getElementById('full-name').addEventListener('input', function() {
                resumeData.personal.name = this.value;
                updatePreview();
                markUnsaved();
            });
            
            document.getElementById('job-title').addEventListener('input', function() {
                resumeData.personal.title = this.value;
                updatePreview();
                markUnsaved();
            });
            
            document.getElementById('email').addEventListener('input', function() {
                resumeData.personal.email = this.value;
                updatePreview();
                markUnsaved();
            });
            
            document.getElementById('phone').addEventListener('input', function() {
                resumeData.personal.phone = this.value;
                updatePreview();
                markUnsaved();
            });
            
            document.getElementById('address').addEventListener('input', function() {
                resumeData.personal.address = this.value;
                updatePreview();
                markUnsaved();
            });
            
            document.getElementById('summary').addEventListener('input', function() {
                resumeData.personal.summary = this.value;
                updatePreview();
                markUnsaved();
            });
            
            // Profile image upload
            document.getElementById('profile-image').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        resumeData.personal.image = event.target.result;
                        updatePreview();
                        markUnsaved();
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // Social links
            document.getElementById('add-social').addEventListener('click', function() {
                addSocialLink();
            });
            
            // Experience
            document.getElementById('add-experience').addEventListener('click', function() {
                addExperience();
            });
            
            // Education
            document.getElementById('add-education').addEventListener('click', function() {
                addEducation();
            });
            
            // Skills
            document.getElementById('add-skill').addEventListener('click', function() {
                addSkill();
            });
            
            // Add initial items
            addExperience();
            addEducation();
            addSkill();
            addSocialLink();
        }

        // Customization initialization
        function initializeCustomization() {
            // Theme selection
            document.querySelectorAll('.theme-option').forEach(option => {
                option.addEventListener('click', function() {
                    if (this.style.backgroundColor !== 'white') {
                        document.querySelectorAll('.theme-option').forEach(o => o.classList.remove('selected'));
                        this.classList.add('selected');
                        
                        const theme = this.getAttribute('data-theme');
                        if (theme) {
                            resumeData.settings.theme = theme;
                            document.body.className = document.body.className.replace(/theme-\w+/g, '') + ' ' + theme;
                            
                            // Hide custom color picker if not using custom theme
                            document.getElementById('custom-color-picker').style.display = 'none';
                        } else {
                            // Custom theme selected
                            document.getElementById('custom-color-picker').style.display = 'flex';
                        }
                        
                        updatePreview();
                        markUnsaved();
                    }
                });
            });
            
            // Custom color picker
            document.getElementById('primary-color').addEventListener('input', function() {
                document.documentElement.style.setProperty('--primary-color', this.value);
                updatePreview();
                markUnsaved();
            });
            
            document.getElementById('secondary-color').addEventListener('input', function() {
                document.documentElement.style.setProperty('--secondary-color', this.value);
                updatePreview();
                markUnsaved();
            });
            
            document.getElementById('header-color').addEventListener('input', function() {
                document.documentElement.style.setProperty('--header-color', this.value);
                updatePreview();
                markUnsaved();
            });
            
            // Font selection
            document.querySelectorAll('.font-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.font-option').forEach(o => o.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    const font = this.getAttribute('data-font');
                    resumeData.settings.font = font;
                    document.body.className = document.body.className.replace(/font-\w+/g, '') + ' ' + font;
                    
                    updatePreview();
                    markUnsaved();
                });
            });
            
            // Template selection
            document.querySelectorAll('.template-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.template-option').forEach(o => o.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    const template = this.getAttribute('data-template');
                    resumeData.settings.template = template;
                    resumePreview.className = resumePreview.className.replace(/template-\w+/g, '') + ' ' + template;
                    
                    updatePreview();
                    markUnsaved();
                });
            });
        }

        // Action buttons initialization
        function initializeActionButtons() {
            // Preview button
            document.getElementById('preview-btn').addEventListener('click', function() {
                generatePreview();
            });
            
            // Refresh preview button
            document.getElementById('refresh-preview').addEventListener('click', function() {
                generatePreview();
            });
            
            // Download PDF button
            document.getElementById('download-pdf').addEventListener('click', function() {
                downloadPDF();
            });
            
            // Download DOC button
            document.getElementById('download-doc').addEventListener('click', function() {
                downloadDOC();
            });
            
            // Print button
            document.getElementById('print-btn').addEventListener('click', function() {
                window.print();
            });
            
            // Reset button
            document.getElementById('reset-btn').addEventListener('click', function() {
                if (confirm('Are you sure you want to reset all data? This cannot be undone.')) {
                    resetForm();
                }
            });
        }

        // Form item management
        function addSocialLink() {
            const id = Date.now();
            resumeData.personal.social.push({
                id: id,
                platform: '',
                url: ''
            });
            
            const socialLinksContainer = document.getElementById('social-links');
            const socialItem = document.createElement('div');
            socialItem.className = 'item';
            socialItem.innerHTML = `
                <div class="form-group">
                    <label>Platform</label>
                    <input type="text" class="social-platform" placeholder="LinkedIn, GitHub, etc." data-id="${id}" />
                </div>
                <div class="form-group">
                    <label>URL</label>
                    <input type="text" class="social-url" placeholder="https://..." data-id="${id}" />
                </div>
                <button class="remove-item" data-id="${id}">×</button>
            `;
            socialLinksContainer.appendChild(socialItem);
            
            // Add event listeners
            socialItem.querySelector('.social-platform').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.personal.social.find(s => s.id === itemId);
                if (item) {
                    item.platform = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            socialItem.querySelector('.social-url').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.personal.social.find(s => s.id === itemId);
                if (item) {
                    item.url = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            socialItem.querySelector('.remove-item').addEventListener('click', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                resumeData.personal.social = resumeData.personal.social.filter(s => s.id !== itemId);
                socialItem.remove();
                updatePreview();
                markUnsaved();
            });
        }

        function addExperience() {
            const id = Date.now();
            resumeData.experience.push({
                id: id,
                company: '',
                position: '',
                startDate: '',
                endDate: '',
                description: ''
            });
            
            const experienceContainer = document.getElementById('experience-items');
            const experienceItem = document.createElement('div');
            experienceItem.className = 'item';
            experienceItem.innerHTML = `
                <div class="form-group">
                    <label>Company</label>
                    <input type="text" class="experience-company" placeholder="Company Name" data-id="${id}" />
                </div>
                <div class="form-group">
                    <label>Position</label>
                    <input type="text" class="experience-position" placeholder="Job Title" data-id="${id}" />
                </div>
                <div class="form-group">
                    <div style="display: flex; gap: 10px;">
                        <div style="flex: 1;">
                            <label>Start Date</label>
                            <input type="text" class="experience-start" placeholder="MM/YYYY" data-id="${id}" />
                        </div>
                        <div style="flex: 1;">
                            <label>End Date</label>
                            <input type="text" class="experience-end" placeholder="MM/YYYY or Present" data-id="${id}" />
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea class="experience-description" placeholder="Describe your responsibilities and achievements" data-id="${id}"></textarea>
                </div>
                <button class="remove-item" data-id="${id}">×</button>
            `;
            experienceContainer.appendChild(experienceItem);
            
            // Add event listeners
            experienceItem.querySelector('.experience-company').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.experience.find(e => e.id === itemId);
                if (item) {
                    item.company = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            experienceItem.querySelector('.experience-position').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.experience.find(e => e.id === itemId);
                if (item) {
                    item.position = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            experienceItem.querySelector('.experience-start').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.experience.find(e => e.id === itemId);
                if (item) {
                    item.startDate = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            experienceItem.querySelector('.experience-end').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.experience.find(e => e.id === itemId);
                if (item) {
                    item.endDate = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            experienceItem.querySelector('.experience-description').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.experience.find(e => e.id === itemId);
                if (item) {
                    item.description = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            experienceItem.querySelector('.remove-item').addEventListener('click', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                resumeData.experience = resumeData.experience.filter(e => e.id !== itemId);
                experienceItem.remove();
                updatePreview();
                markUnsaved();
            });
        }

        function addEducation() {
            const id = Date.now();
            resumeData.education.push({
                id: id,
                institution: '',
                degree: '',
                field: '',
                startDate: '',
                endDate: '',
                description: ''
            });
            
            const educationContainer = document.getElementById('education-items');
            const educationItem = document.createElement('div');
            educationItem.className = 'item';
            educationItem.innerHTML = `
                <div class="form-group">
                    <label>Institution</label>
                    <input type="text" class="education-institution" placeholder="University Name" data-id="${id}" />
                </div>
                <div class="form-group">
                    <label>Degree</label>
                    <input type="text" class="education-degree" placeholder="Bachelor of Science" data-id="${id}" />
                </div>
                <div class="form-group">
                    <label>Field of Study</label>
                    <input type="text" class="education-field" placeholder="Computer Science" data-id="${id}" />
                </div>
                <div class="form-group">
                    <div style="display: flex; gap: 10px;">
                        <div style="flex: 1;">
                            <label>Start Date</label>
                            <input type="text" class="education-start" placeholder="MM/YYYY" data-id="${id}" />
                        </div>
                        <div style="flex: 1;">
                            <label>End Date</label>
                            <input type="text" class="education-end" placeholder="MM/YYYY or Present" data-id="${id}" />
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea class="education-description" placeholder="Academic achievements, honors, etc." data-id="${id}"></textarea>
                </div>
                <button class="remove-item" data-id="${id}">×</button>
            `;
            educationContainer.appendChild(educationItem);
            
            // Add event listeners
            educationItem.querySelector('.education-institution').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.education.find(e => e.id === itemId);
                if (item) {
                    item.institution = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            educationItem.querySelector('.education-degree').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.education.find(e => e.id === itemId);
                if (item) {
                    item.degree = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            educationItem.querySelector('.education-field').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.education.find(e => e.id === itemId);
                if (item) {
                    item.field = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            educationItem.querySelector('.education-start').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.education.find(e => e.id === itemId);
                if (item) {
                    item.startDate = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            educationItem.querySelector('.education-end').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.education.find(e => e.id === itemId);
                if (item) {
                    item.endDate = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            educationItem.querySelector('.education-description').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.education.find(e => e.id === itemId);
                if (item) {
                    item.description = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            educationItem.querySelector('.remove-item').addEventListener('click', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                resumeData.education = resumeData.education.filter(e => e.id !== itemId);
                educationItem.remove();
                updatePreview();
                markUnsaved();
            });
        }

        function addSkill() {
            const id = Date.now();
            resumeData.skills.push({
                id: id,
                name: '',
                level: ''
            });
            
            const skillsContainer = document.getElementById('skill-items');
            const skillItem = document.createElement('div');
            skillItem.className = 'item';
            skillItem.innerHTML = `
                <div class="form-group">
                    <label>Skill Name</label>
                    <input type="text" class="skill-name" placeholder="JavaScript, Project Management, etc." data-id="${id}" />
                </div>
                <div class="form-group">
                    <label>Proficiency Level</label>
                    <select class="skill-level" data-id="${id}">
                        <option value="">Select Level</option>
                        <option value="Beginner">Beginner</option>
                        <option value="Intermediate">Intermediate</option>
                        <option value="Advanced">Advanced</option>
                        <option value="Expert">Expert</option>
                    </select>
                </div>
                <button class="remove-item" data-id="${id}">×</button>
            `;
            skillsContainer.appendChild(skillItem);
            
            // Add event listeners
            skillItem.querySelector('.skill-name').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.skills.find(s => s.id === itemId);
                if (item) {
                    item.name = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            skillItem.querySelector('.skill-level').addEventListener('change', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.skills.find(s => s.id === itemId);
                if (item) {
                    item.level = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            skillItem.querySelector('.remove-item').addEventListener('click', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                resumeData.skills = resumeData.skills.filter(s => s.id !== itemId);
                skillItem.remove();
                updatePreview();
                markUnsaved();
            });
        }

        // Preview generation
        function generatePreview() {
            updatePreview();
        }

        function updatePreview() {
            const personal = resumeData.personal;
            const experience = resumeData.experience;
            const education = resumeData.education;
            const skills = resumeData.skills;
            
            let previewHTML = '';
            
            // Header section
            previewHTML += `
                <div class="resume-header">
                    ${personal.image ? `<div class="profile-image-container"><img src="${personal.image}" alt="Profile" class="profile-image" /></div>` : ''}
                    <h1 class="resume-name">${personal.name || 'Your Name'}</h1>
                    <div class="resume-title">${personal.title || 'Professional Title'}</div>
                    <div class="resume-contact">
                        ${personal.email ? `<div>${personal.email}</div>` : ''}
                        ${personal.phone ? `<div>${personal.phone}</div>` : ''}
                        ${personal.address ? `<div>${personal.address}</div>` : ''}
                    </div>
                    ${personal.social.filter(s => s.platform && s.url).length > 0 ? `
                        <div class="resume-social">
                            ${personal.social.filter(s => s.platform && s.url).map(s => 
                                `<a href="${s.url}" target="_blank">${s.platform}</a>`
                            ).join(' | ')}
                        </div>
                    ` : ''}
                </div>
            `;
            
            // Professional Summary
            if (personal.summary) {
                previewHTML += `
                    <div class="resume-section">
                        <h2 class="resume-section-title">Professional Summary</h2>
                        <p>${personal.summary}</p>
                    </div>
                `;
            }
            
            // Work Experience
            if (experience.length > 0 && experience.some(e => e.company || e.position)) {
                previewHTML += `
                    <div class="resume-section">
                        <h2 class="resume-section-title">Work Experience</h2>
                        ${experience.filter(e => e.company || e.position).map(exp => `
                            <div class="resume-item">
                                <div class="resume-item-header">
                                    <div class="resume-item-title">${exp.position || 'Position'}</div>
                                    <div class="resume-item-date">${exp.startDate || ''} ${exp.endDate ? ' - ' + exp.endDate : ''}</div>
                                </div>
                                <div class="resume-item-subtitle">${exp.company || 'Company'}</div>
                                ${exp.description ? `<p>${exp.description}</p>` : ''}
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            // Education
            if (education.length > 0 && education.some(e => e.institution || e.degree)) {
                previewHTML += `
                    <div class="resume-section">
                        <h2 class="resume-section-title">Education</h2>
                        ${education.filter(e => e.institution || e.degree).map(edu => `
                            <div class="resume-item">
                                <div class="resume-item-header">
                                    <div class="resume-item-title">${edu.degree || 'Degree'}</div>
                                    <div class="resume-item-date">${edu.startDate || ''} ${edu.endDate ? ' - ' + edu.endDate : ''}</div>
                                </div>
                                <div class="resume-item-subtitle">${edu.institution || 'Institution'} ${edu.field ? `- ${edu.field}` : ''}</div>
                                ${edu.description ? `<p>${edu.description}</p>` : ''}
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            // Skills
            if (skills.length > 0 && skills.some(s => s.name)) {
                previewHTML += `
                    <div class="resume-section">
                        <h2 class="resume-section-title">Skills</h2>
                        <div class="resume-skills">
                            ${skills.filter(s => s.name).map(skill => `
                                <div class="skill-tag">${skill.name}${skill.level ? ` (${skill.level})` : ''}</div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
            
            resumePreview.innerHTML = previewHTML;
        }

        // Download functionality
        function downloadPDF() {
            showLoading();
            
            // Use html2canvas and jsPDF to generate PDF
            html2canvas(resumePreview, {
                scale: 2,
                useCORS: true,
                logging: false
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jsPDF('p', 'mm', 'a4');
                const imgWidth = 210; // A4 width in mm
                const pageHeight = 295; // A4 height in mm
                const imgHeight = canvas.height * imgWidth / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;
                
                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
                
                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }
                
                pdf.save('resume.pdf');
                hideLoading();
            }).catch(error => {
                console.error('Error generating PDF:', error);
                hideLoading();
                alert('Error generating PDF. Please try again.');
            });
        }

        function downloadDOC() {
            showLoading();
            
            try {
                // Create a simple HTML document for Word
                const htmlContent = `
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <meta charset="UTF-8">
                        <title>Resume - ${resumeData.personal.name || 'Your Name'}</title>
                        <style>
                            body { font-family: Arial, sans-serif; line-height: 1.6; }
                            h1 { color: #2c3e50; font-size: 24pt; margin-bottom: 5px; }
                            h2 { color: #3498db; font-size: 14pt; border-bottom: 1px solid #3498db; padding-bottom: 3px; }
                            .contact-info { margin-bottom: 15px; }
                            .section { margin-bottom: 15px; }
                            .item { margin-bottom: 10px; }
                            .item-header { display: flex; justify-content: space-between; }
                            .item-title { font-weight: bold; }
                            .item-date { color: #666; }
                            .item-subtitle { font-style: italic; color: #666; margin-bottom: 5px; }
                            .skills { display: flex; flex-wrap: wrap; gap: 5px; }
                            .skill-tag { background-color: #3498db; color: white; padding: 2px 8px; border-radius: 10px; font-size: 9pt; }
                        </style>
                    </head>
                    <body>
                        <h1>${resumeData.personal.name || 'Your Name'}</h1>
                        <div class="contact-info">
                            <div>${resumeData.personal.title || 'Professional Title'}</div>
                            <div>${resumeData.personal.email || ''}</div>
                            <div>${resumeData.personal.phone || ''}</div>
                            <div>${resumeData.personal.address || ''}</div>
                        </div>
                        
                        ${resumeData.personal.summary ? `
                            <div class="section">
                                <h2>Professional Summary</h2>
                                <p>${resumeData.personal.summary}</p>
                            </div>
                        ` : ''}
                        
                        ${resumeData.experience.length > 0 && resumeData.experience.some(e => e.company || e.position) ? `
                            <div class="section">
                                <h2>Work Experience</h2>
                                ${resumeData.experience.filter(e => e.company || e.position).map(exp => `
                                    <div class="item">
                                        <div class="item-header">
                                            <div class="item-title">${exp.position || 'Position'}</div>
                                            <div class="item-date">${exp.startDate || ''} ${exp.endDate ? ' - ' + exp.endDate : ''}</div>
                                        </div>
                                        <div class="item-subtitle">${exp.company || 'Company'}</div>
                                        ${exp.description ? `<p>${exp.description}</p>` : ''}
                                    </div>
                                `).join('')}
                            </div>
                        ` : ''}
                        
                        ${resumeData.education.length > 0 && resumeData.education.some(e => e.institution || e.degree) ? `
                            <div class="section">
                                <h2>Education</h2>
                                ${resumeData.education.filter(e => e.institution || e.degree).map(edu => `
                                    <div class="item">
                                        <div class="item-header">
                                            <div class="item-title">${edu.degree || 'Degree'}</div>
                                            <div class="item-date">${edu.startDate || ''} ${edu.endDate ? ' - ' + edu.endDate : ''}</div>
                                        </div>
                                        <div class="item-subtitle">${edu.institution || 'Institution'} ${edu.field ? `- ${edu.field}` : ''}</div>
                                        ${edu.description ? `<p>${edu.description}</p>` : ''}
                                    </div>
                                `).join('')}
                            </div>
                        ` : ''}
                        
                        ${resumeData.skills.length > 0 && resumeData.skills.some(s => s.name) ? `
                            <div class="section">
                                <h2>Skills</h2>
                                <div class="skills">
                                    ${resumeData.skills.filter(s => s.name).map(skill => `
                                        <div class="skill-tag">${skill.name}${skill.level ? ` (${skill.level})` : ''}</div>
                                    `).join('')}
                                </div>
                            </div>
                        ` : ''}
                    </body>
                    </html>
                `;
                
                // Create a Blob with the HTML content
                const blob = new Blob([htmlContent], { type: 'application/msword' });
                
                // Create a download link and trigger it
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'resume.doc';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                hideLoading();
            } catch (error) {
                console.error('Error generating DOC:', error);
                hideLoading();
                alert('Error generating DOC file. Please try again.');
            }
        }

        // Local storage
        function saveToLocalStorage() {
            try {
                localStorage.setItem('resumeData', JSON.stringify(resumeData));
                autoSaveStatus.textContent = 'Auto-saved';
                autoSaveStatus.style.color = '#27ae60';
                
                setTimeout(() => {
                    autoSaveStatus.style.color = '#666';
                }, 2000);
            } catch (error) {
                console.error('Error saving to localStorage:', error);
            }
        }

        function loadFromLocalStorage() {
            try {
                const savedData = localStorage.getItem('resumeData');
                if (savedData) {
                    const parsedData = JSON.parse(savedData);
                    
                    // Update resumeData with saved values
                    Object.assign(resumeData, parsedData);
                    
                    // Update form fields
                    document.getElementById('full-name').value = resumeData.personal.name || '';
                    document.getElementById('job-title').value = resumeData.personal.title || '';
                    document.getElementById('email').value = resumeData.personal.email || '';
                    document.getElementById('phone').value = resumeData.personal.phone || '';
                    document.getElementById('address').value = resumeData.personal.address || '';
                    document.getElementById('summary').value = resumeData.personal.summary || '';
                    
                    // Update theme, font, and template
                    if (resumeData.settings.theme) {
                        document.body.className = document.body.className.replace(/theme-\w+/g, '') + ' ' + resumeData.settings.theme;
                        document.querySelectorAll('.theme-option').forEach(o => {
                            if (o.getAttribute('data-theme') === resumeData.settings.theme) {
                                o.classList.add('selected');
                            } else {
                                o.classList.remove('selected');
                            }
                        });
                    }
                    
                    if (resumeData.settings.font) {
                        document.body.className = document.body.className.replace(/font-\w+/g, '') + ' ' + resumeData.settings.font;
                        document.querySelectorAll('.font-option').forEach(o => {
                            if (o.getAttribute('data-font') === resumeData.settings.font) {
                                o.classList.add('selected');
                            } else {
                                o.classList.remove('selected');
                            }
                        });
                    }
                    
                    if (resumeData.settings.template) {
                        resumePreview.className = resumePreview.className.replace(/template-\w+/g, '') + ' ' + resumeData.settings.template;
                        document.querySelectorAll('.template-option').forEach(o => {
                            if (o.getAttribute('data-template') === resumeData.settings.template) {
                                o.classList.add('selected');
                            } else {
                                o.classList.remove('selected');
                            }
                        });
                    }
                    
                    // Clear existing items and re-add them with saved data
                    document.getElementById('social-links').innerHTML = '';
                    document.getElementById('experience-items').innerHTML = '';
                    document.getElementById('education-items').innerHTML = '';
                    document.getElementById('skill-items').innerHTML = '';
                    
                    // Add social links
                    resumeData.personal.social.forEach(social => {
                        addSocialLinkElement(social);
                    });
                    
                    // Add experience items
                    resumeData.experience.forEach(exp => {
                        addExperienceElement(exp);
                    });
                    
                    // Add education items
                    resumeData.education.forEach(edu => {
                        addEducationElement(edu);
                    });
                    
                    // Add skill items
                    resumeData.skills.forEach(skill => {
                        addSkillElement(skill);
                    });
                    
                    updatePreview();
                }
            } catch (error) {
                console.error('Error loading from localStorage:', error);
            }
        }

        // Helper functions for loading saved items
        function addSocialLinkElement(social) {
            const socialLinksContainer = document.getElementById('social-links');
            const socialItem = document.createElement('div');
            socialItem.className = 'item';
            socialItem.innerHTML = `
                <div class="form-group">
                    <label>Platform</label>
                    <input type="text" class="social-platform" placeholder="LinkedIn, GitHub, etc." data-id="${social.id}" value="${social.platform || ''}" />
                </div>
                <div class="form-group">
                    <label>URL</label>
                    <input type="text" class="social-url" placeholder="https://..." data-id="${social.id}" value="${social.url || ''}" />
                </div>
                <button class="remove-item" data-id="${social.id}">×</button>
            `;
            socialLinksContainer.appendChild(socialItem);
            
            // Add event listeners
            socialItem.querySelector('.social-platform').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.personal.social.find(s => s.id === itemId);
                if (item) {
                    item.platform = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            socialItem.querySelector('.social-url').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.personal.social.find(s => s.id === itemId);
                if (item) {
                    item.url = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            socialItem.querySelector('.remove-item').addEventListener('click', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                resumeData.personal.social = resumeData.personal.social.filter(s => s.id !== itemId);
                socialItem.remove();
                updatePreview();
                markUnsaved();
            });
        }

        function addExperienceElement(exp) {
            const experienceContainer = document.getElementById('experience-items');
            const experienceItem = document.createElement('div');
            experienceItem.className = 'item';
            experienceItem.innerHTML = `
                <div class="form-group">
                    <label>Company</label>
                    <input type="text" class="experience-company" placeholder="Company Name" data-id="${exp.id}" value="${exp.company || ''}" />
                </div>
                <div class="form-group">
                    <label>Position</label>
                    <input type="text" class="experience-position" placeholder="Job Title" data-id="${exp.id}" value="${exp.position || ''}" />
                </div>
                <div class="form-group">
                    <div style="display: flex; gap: 10px;">
                        <div style="flex: 1;">
                            <label>Start Date</label>
                            <input type="text" class="experience-start" placeholder="MM/YYYY" data-id="${exp.id}" value="${exp.startDate || ''}" />
                        </div>
                        <div style="flex: 1;">
                            <label>End Date</label>
                            <input type="text" class="experience-end" placeholder="MM/YYYY or Present" data-id="${exp.id}" value="${exp.endDate || ''}" />
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea class="experience-description" placeholder="Describe your responsibilities and achievements" data-id="${exp.id}">${exp.description || ''}</textarea>
                </div>
                <button class="remove-item" data-id="${exp.id}">×</button>
            `;
            experienceContainer.appendChild(experienceItem);
            
            // Add event listeners
            experienceItem.querySelector('.experience-company').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.experience.find(e => e.id === itemId);
                if (item) {
                    item.company = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            experienceItem.querySelector('.experience-position').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.experience.find(e => e.id === itemId);
                if (item) {
                    item.position = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            experienceItem.querySelector('.experience-start').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.experience.find(e => e.id === itemId);
                if (item) {
                    item.startDate = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            experienceItem.querySelector('.experience-end').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.experience.find(e => e.id === itemId);
                if (item) {
                    item.endDate = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            experienceItem.querySelector('.experience-description').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.experience.find(e => e.id === itemId);
                if (item) {
                    item.description = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            experienceItem.querySelector('.remove-item').addEventListener('click', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                resumeData.experience = resumeData.experience.filter(e => e.id !== itemId);
                experienceItem.remove();
                updatePreview();
                markUnsaved();
            });
        }

        function addEducationElement(edu) {
            const educationContainer = document.getElementById('education-items');
            const educationItem = document.createElement('div');
            educationItem.className = 'item';
            educationItem.innerHTML = `
                <div class="form-group">
                    <label>Institution</label>
                    <input type="text" class="education-institution" placeholder="University Name" data-id="${edu.id}" value="${edu.institution || ''}" />
                </div>
                <div class="form-group">
                    <label>Degree</label>
                    <input type="text" class="education-degree" placeholder="Bachelor of Science" data-id="${edu.id}" value="${edu.degree || ''}" />
                </div>
                <div class="form-group">
                    <label>Field of Study</label>
                    <input type="text" class="education-field" placeholder="Computer Science" data-id="${edu.id}" value="${edu.field || ''}" />
                </div>
                <div class="form-group">
                    <div style="display: flex; gap: 10px;">
                        <div style="flex: 1;">
                            <label>Start Date</label>
                            <input type="text" class="education-start" placeholder="MM/YYYY" data-id="${edu.id}" value="${edu.startDate || ''}" />
                        </div>
                        <div style="flex: 1;">
                            <label>End Date</label>
                            <input type="text" class="education-end" placeholder="MM/YYYY or Present" data-id="${edu.id}" value="${edu.endDate || ''}" />
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea class="education-description" placeholder="Academic achievements, honors, etc." data-id="${edu.id}">${edu.description || ''}</textarea>
                </div>
                <button class="remove-item" data-id="${edu.id}">×</button>
            `;
            educationContainer.appendChild(educationItem);
            
            // Add event listeners
            educationItem.querySelector('.education-institution').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.education.find(e => e.id === itemId);
                if (item) {
                    item.institution = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            educationItem.querySelector('.education-degree').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.education.find(e => e.id === itemId);
                if (item) {
                    item.degree = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            educationItem.querySelector('.education-field').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.education.find(e => e.id === itemId);
                if (item) {
                    item.field = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            educationItem.querySelector('.education-start').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.education.find(e => e.id === itemId);
                if (item) {
                    item.startDate = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            educationItem.querySelector('.education-end').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.education.find(e => e.id === itemId);
                if (item) {
                    item.endDate = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            educationItem.querySelector('.education-description').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.education.find(e => e.id === itemId);
                if (item) {
                    item.description = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            educationItem.querySelector('.remove-item').addEventListener('click', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                resumeData.education = resumeData.education.filter(e => e.id !== itemId);
                educationItem.remove();
                updatePreview();
                markUnsaved();
            });
        }

        function addSkillElement(skill) {
            const skillsContainer = document.getElementById('skill-items');
            const skillItem = document.createElement('div');
            skillItem.className = 'item';
            skillItem.innerHTML = `
                <div class="form-group">
                    <label>Skill Name</label>
                    <input type="text" class="skill-name" placeholder="JavaScript, Project Management, etc." data-id="${skill.id}" value="${skill.name || ''}" />
                </div>
                <div class="form-group">
                    <label>Proficiency Level</label>
                    <select class="skill-level" data-id="${skill.id}">
                        <option value="">Select Level</option>
                        <option value="Beginner" ${skill.level === 'Beginner' ? 'selected' : ''}>Beginner</option>
                        <option value="Intermediate" ${skill.level === 'Intermediate' ? 'selected' : ''}>Intermediate</option>
                        <option value="Advanced" ${skill.level === 'Advanced' ? 'selected' : ''}>Advanced</option>
                        <option value="Expert" ${skill.level === 'Expert' ? 'selected' : ''}>Expert</option>
                    </select>
                </div>
                <button class="remove-item" data-id="${skill.id}">×</button>
            `;
            skillsContainer.appendChild(skillItem);
            
            // Add event listeners
            skillItem.querySelector('.skill-name').addEventListener('input', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.skills.find(s => s.id === itemId);
                if (item) {
                    item.name = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            skillItem.querySelector('.skill-level').addEventListener('change', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                const item = resumeData.skills.find(s => s.id === itemId);
                if (item) {
                    item.level = this.value;
                    updatePreview();
                    markUnsaved();
                }
            });
            
            skillItem.querySelector('.remove-item').addEventListener('click', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                resumeData.skills = resumeData.skills.filter(s => s.id !== itemId);
                skillItem.remove();
                updatePreview();
                markUnsaved();
            });
        }

        // Reset form
        function resetForm() {
            if (confirm('Are you sure you want to reset all data? This cannot be undone.')) {
                // Clear resume data
                resumeData.personal = {
                    name: "",
                    title: "",
                    email: "",
                    phone: "",
                    address: "",
                    summary: "",
                    image: "",
                    social: []
                };
                resumeData.experience = [];
                resumeData.education = [];
                resumeData.skills = [];
                
                // Reset form fields
                document.getElementById('full-name').value = '';
                document.getElementById('job-title').value = '';
                document.getElementById('email').value = '';
                document.getElementById('phone').value = '';
                document.getElementById('address').value = '';
                document.getElementById('summary').value = '';
                document.getElementById('profile-image').value = '';
                
                // Clear item lists
                document.getElementById('social-links').innerHTML = '';
                document.getElementById('experience-items').innerHTML = '';
                document.getElementById('education-items').innerHTML = '';
                document.getElementById('skill-items').innerHTML = '';
                
                // Reset to default theme, font, and template
                resumeData.settings.theme = 'theme-default';
                resumeData.settings.font = 'font-arial';
                resumeData.settings.template = 'template-standard';
                
                document.body.className = 'theme-default font-arial';
                resumePreview.className = 'resume-preview template-standard';
                
                document.querySelectorAll('.theme-option').forEach(o => {
                    if (o.getAttribute('data-theme') === 'theme-default') {
                        o.classList.add('selected');
                    } else {
                        o.classList.remove('selected');
                    }
                });
                
                document.querySelectorAll('.font-option').forEach(o => {
                    if (o.getAttribute('data-font') === 'font-arial') {
                        o.classList.add('selected');
                    } else {
                        o.classList.remove('selected');
                    }
                });
                
                document.querySelectorAll('.template-option').forEach(o => {
                    if (o.getAttribute('data-template') === 'template-standard') {
                        o.classList.add('selected');
                    } else {
                        o.classList.remove('selected');
                    }
                });
                
                // Hide custom color picker
                document.getElementById('custom-color-picker').style.display = 'none';
                
                // Add initial items
                addSocialLink();
                addExperience();
                addEducation();
                addSkill();
                
                // Update preview
                updatePreview();
                
                // Clear localStorage
                localStorage.removeItem('resumeData');
                
                markUnsaved();
            }
        }

        // Utility functions
        function showLoading() {
            loadingElement.style.display = 'flex';
        }

        function hideLoading() {
            loadingElement.style.display = 'none';
        }

        function markUnsaved() {
            autoSaveStatus.textContent = 'Unsaved changes';
            autoSaveStatus.style.color = '#e74c3c';
        }
    </script>
</body>
</html>