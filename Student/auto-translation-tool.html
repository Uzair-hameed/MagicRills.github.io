<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Enhanced Auto Translation Tool - English ‚Üî Urdu</title>
  <style>
    :root {
      --primary: #007BFF;
      --secondary: #28a745;
      --error: #dc3545;
      --warning: #ffc107;
      --light: #f8f9fa;
      --dark: #343a40;
    }
    
    * {
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      margin: 0;
      padding: 20px;
      min-height: 100vh;
    }

    .container {
      max-width: 800px;
      margin: auto;
      background: #fff;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }

    h1 {
      margin-bottom: 20px;
      color: var(--dark);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .input-group {
      margin-bottom: 20px;
    }

    textarea {
      width: 100%;
      height: 120px;
      padding: 15px;
      font-size: 16px;
      border-radius: 8px;
      border: 2px solid #e1e5e9;
      resize: vertical;
      transition: border-color 0.3s;
      font-family: inherit;
    }

    textarea:focus {
      outline: none;
      border-color: var(--primary);
    }

    .textarea-container {
      position: relative;
    }

    .char-count {
      position: absolute;
      bottom: 10px;
      right: 15px;
      font-size: 12px;
      color: #6c757d;
    }

    .controls {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin: 20px 0;
    }

    select, button {
      padding: 10px 15px;
      font-size: 16px;
      border-radius: 8px;
      border: 1px solid #ced4da;
      background-color: white;
      cursor: pointer;
      transition: all 0.2s;
    }

    select:focus, button:focus {
      outline: none;
      box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25);
    }

    #swapBtn {
      background: var(--primary);
      color: white;
      border: none;
    }

    #swapBtn:hover {
      background: #0069d9;
      transform: translateY(-2px);
    }

    #translateBtn {
      background: var(--secondary);
      color: white;
      border: none;
      text-decoration: none;
      display: inline-block;
    }

    #translateBtn:hover {
      background: #218838;
      transform: translateY(-2px);
    }

    .output {
      background: var(--light);
      border: 2px solid #e1e5e9;
      min-height: 120px;
      padding: 15px;
      border-radius: 8px;
      margin-top: 20px;
      text-align: left;
      white-space: pre-wrap;
      position: relative;
    }

    .output-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .output-title {
      font-weight: bold;
      color: var(--dark);
    }

    .output-actions {
      display: flex;
      gap: 10px;
    }

    .action-btn {
      background: none;
      border: 1px solid #ced4da;
      padding: 5px 10px;
      font-size: 14px;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .action-btn:hover {
      background: #e9ecef;
    }

    .error-highlight {
      background-color: rgba(220, 53, 69, 0.1);
      border-bottom: 2px wavy var(--error);
    }

    .grammar-suggestions {
      margin-top: 15px;
      padding: 10px;
      background: #fff3cd;
      border-radius: 4px;
      border-left: 4px solid var(--warning);
    }

    .suggestion-item {
      margin: 5px 0;
      padding: 5px;
      border-radius: 4px;
    }

    .suggestion-item:hover {
      background: #e2e6ea;
    }

    .loader {
      display: none;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(0, 123, 255, 0.3);
      border-radius: 50%;
      border-top-color: var(--primary);
      animation: spin 1s ease-in-out infinite;
      margin: 0 auto;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .language-display {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      font-weight: bold;
      color: var(--dark);
    }

    .feature-tabs {
      display: flex;
      margin-bottom: 20px;
      border-bottom: 1px solid #e1e5e9;
    }

    .tab {
      padding: 10px 20px;
      cursor: pointer;
      border-bottom: 3px solid transparent;
    }

    .tab.active {
      border-bottom: 3px solid var(--primary);
      color: var(--primary);
      font-weight: bold;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    @media (max-width: 600px) {
      .container {
        padding: 15px;
      }
      
      .controls {
        flex-direction: column;
      }
      
      select, button {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üîÑ Enhanced Translation Tool</h1>
    
    <div class="feature-tabs">
      <div class="tab active" onclick="switchTab('translation')">Translation</div>
      <div class="tab" onclick="switchTab('grammar')">Grammar Check</div>
    </div>
    
    <div class="tab-content active" id="translation-tab">
      <div class="language-display">
        <span id="fromLangDisplay">English</span>
        <span>‚Üí</span>
        <span id="toLangDisplay">Urdu</span>
      </div>
      
      <div class="input-group">
        <div class="textarea-container">
          <textarea id="inputText" placeholder="Type text here..."></textarea>
          <div class="char-count"><span id="charCount">0</span> characters</div>
        </div>
      </div>
      
      <div class="controls">
        <select id="fromLang">
          <option value="en">English</option>
          <option value="ur">Urdu</option>
        </select>
        
        <button id="swapBtn" onclick="swapLanguages()">üîÅ Swap</button>
        
        <select id="toLang">
          <option value="ur">Urdu</option>
          <option value="en">English</option>
        </select>
        
        <button id="translateBtn" onclick="translateText()">Translate</button>
      </div>
      
      <div class="output">
        <div class="output-header">
          <div class="output-title">Translation</div>
          <div class="output-actions">
            <button class="action-btn" onclick="copyToClipboard('outputBox')">Copy</button>
            <button class="action-btn" onclick="speakText('outputBox')">üîä Speak</button>
          </div>
        </div>
        <div id="outputBox">Translated text will appear here...</div>
        <div class="loader" id="translationLoader"></div>
      </div>
    </div>
    
    <div class="tab-content" id="grammar-tab">
      <div class="input-group">
        <div class="textarea-container">
          <textarea id="grammarInput" placeholder="Type text here to check grammar..."></textarea>
          <div class="char-count"><span id="grammarCharCount">0</span> characters</div>
        </div>
      </div>
      
      <div class="controls">
        <button id="checkGrammarBtn" onclick="checkGrammar()">Check Grammar</button>
      </div>
      
      <div class="output">
        <div class="output-header">
          <div class="output-title">Grammar Check</div>
          <div class="output-actions">
            <button class="action-btn" onclick="copyToClipboard('grammarOutput')">Copy</button>
          </div>
        </div>
        <div id="grammarOutput">Grammar suggestions will appear here...</div>
        <div id="grammarSuggestions" class="grammar-suggestions"></div>
        <div class="loader" id="grammarLoader"></div>
      </div>
    </div>
  </div>

  <script>
    // API key (in a real application, this should be handled securely on the backend)
    const API_KEY = "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";
    
    // DOM elements
    const inputText = document.getElementById('inputText');
    const fromLang = document.getElementById('fromLang');
    const toLang = document.getElementById('toLang');
    const outputBox = document.getElementById('outputBox');
    const charCount = document.getElementById('charCount');
    const grammarInput = document.getElementById('grammarInput');
    const grammarCharCount = document.getElementById('grammarCharCount');
    const grammarOutput = document.getElementById('grammarOutput');
    const grammarSuggestions = document.getElementById('grammarSuggestions');
    const fromLangDisplay = document.getElementById('fromLangDisplay');
    const toLangDisplay = document.getElementById('toLangDisplay');
    
    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      updateLanguageDisplay();
      inputText.addEventListener('input', updateCharCount);
      grammarInput.addEventListener('input', updateGrammarCharCount);
      fromLang.addEventListener('change', updateLanguageDisplay);
      toLang.addEventListener('change', updateLanguageDisplay);
    });
    
    function updateCharCount() {
      charCount.textContent = inputText.value.length;
    }
    
    function updateGrammarCharCount() {
      grammarCharCount.textContent = grammarInput.value.length;
    }
    
    function updateLanguageDisplay() {
      fromLangDisplay.textContent = fromLang.options[fromLang.selectedIndex].text;
      toLangDisplay.textContent = toLang.options[toLang.selectedIndex].text;
    }
    
    function switchTab(tabName) {
      // Hide all tabs
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Remove active class from all tabs
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Show selected tab
      document.getElementById(`${tabName}-tab`).classList.add('active');
      
      // Activate selected tab button
      event.target.classList.add('active');
    }
    
    function swapLanguages() {
      [fromLang.value, toLang.value] = [toLang.value, fromLang.value];
      updateLanguageDisplay();
    }
    
    function translateText() {
      const text = inputText.value.trim();
      const from = fromLang.value;
      const to = toLang.value;

      if (!text) {
        alert("Please enter text to translate.");
        return;
      }

      const translationLoader = document.getElementById('translationLoader');
      translationLoader.style.display = 'block';
      outputBox.textContent = 'Translating...';

      const url = `https://translate.googleapis.com/translate_a/single?client=gtx&sl=${from}&tl=${to}&dt=t&q=${encodeURIComponent(text)}`;

      fetch(url)
        .then(response => response.json())
        .then(data => {
          const translated = data[0].map(item => item[0]).join("");
          outputBox.textContent = translated;
          translationLoader.style.display = 'none';
        })
        .catch(err => {
          outputBox.textContent = "Translation failed. Try again later.";
          console.error("Translation error:", err);
          translationLoader.style.display = 'none';
        });
    }
    
    function checkGrammar() {
      const text = grammarInput.value.trim();

      if (!text) {
        alert("Please enter text to check grammar.");
        return;
      }

      const grammarLoader = document.getElementById('grammarLoader');
      grammarLoader.style.display = 'block';
      grammarOutput.textContent = 'Checking grammar...';
      grammarSuggestions.innerHTML = '';

      // Using OpenRouter API for grammar checking
      fetch("https://openrouter.ai/api/v1/chat/completions", {
        method: "POST",
        headers: {
          "Authorization": `Bearer ${API_KEY}`,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          "model": "openai/gpt-3.5-turbo",
          "messages": [
            {
              "role": "system",
              "content": "You are a helpful grammar checker. Analyze the provided text for grammatical errors, spelling mistakes, and awkward phrasing. Return a JSON object with two properties: 'corrected_text' (the corrected version of the text) and 'suggestions' (an array of objects, each with 'original', 'corrected', and 'explanation' properties)."
            },
            {
              "role": "user",
              "content": `Please check the grammar of this text: "${text}"`
            }
          ]
        })
      })
      .then(response => response.json())
      .then(data => {
        grammarLoader.style.display = 'none';
        
        try {
          const content = data.choices[0].message.content;
          const result = JSON.parse(content);
          
          grammarOutput.innerHTML = result.corrected_text;
          
          if (result.suggestions && result.suggestions.length > 0) {
            grammarSuggestions.innerHTML = '<h4>Suggestions:</h4>';
            result.suggestions.forEach(suggestion => {
              const suggestionElement = document.createElement('div');
              suggestionElement.className = 'suggestion-item';
              suggestionElement.innerHTML = `
                <strong>Original:</strong> ${suggestion.original}<br>
                <strong>Suggested:</strong> ${suggestion.corrected}<br>
                <strong>Explanation:</strong> ${suggestion.explanation}
              `;
              grammarSuggestions.appendChild(suggestionElement);
            });
          } else {
            grammarSuggestions.innerHTML = '<p>No grammar issues found!</p>';
          }
        } catch (e) {
          console.error("Error parsing grammar check response:", e);
          grammarOutput.textContent = "Error processing grammar check. Please try again.";
        }
      })
      .catch(err => {
        grammarLoader.style.display = 'none';
        grammarOutput.textContent = "Grammar check failed. Try again later.";
        console.error("Grammar check error:", err);
      });
    }
    
    function copyToClipboard(elementId) {
      const text = document.getElementById(elementId).textContent;
      navigator.clipboard.writeText(text)
        .then(() => {
          alert('Text copied to clipboard!');
        })
        .catch(err => {
          console.error('Failed to copy text: ', err);
        });
    }
    
    function speakText(elementId) {
      const text = document.getElementById(elementId).textContent;
      if ('speechSynthesis' in window) {
        const utterance = new SpeechSynthesisUtterance(text);
        
        // Set language based on current translation direction
        if (toLang.value === 'ur') {
          utterance.lang = 'ur-PK';
        } else {
          utterance.lang = 'en-US';
        }
        
        speechSynthesis.speak(utterance);
      } else {
        alert('Text-to-speech is not supported in your browser.');
      }
    }
  </script>
</body>
</html>