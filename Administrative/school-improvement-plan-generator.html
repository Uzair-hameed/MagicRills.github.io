<div class="separator" style="clear: both;"><a href="https://cdn-icons-png.flaticon.com/128/9551/9551658.png" style="display: block; padding: 1em 0px; text-align: center;"><img alt="" border="0" data-original-height="128" data-original-width="128" src="https://cdn-icons-png.flaticon.com/128/9551/9551658.png" style="display: none;" width="200" /></a></div>


<html lang="en">
<head>
    <meta charset="UTF-8"></meta>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"></meta>
    <title>School Improvement Plan Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.8.2/docx.js"></script>
    <style>
        body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;line-height:1.6;color:#333;max-width:1200px;margin:0 auto;padding:20px;background-color:#f5f7fa}
        .header{text-align:center;margin-bottom:30px;padding:20px;background:#fff;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,0.1)}
        .header h1{color:#2c3e50;margin-bottom:10px}
        .header p{color:#7f8c8d}
        .btn{display:inline-block;background:#3498db;color:#fff;padding:10px 20px;border:none;border-radius:4px;cursor:pointer;font-size:16px;transition:background .3s}
        .btn:hover{background:#2980b9}
        .btn-secondary{background:#95a5a6}
        .btn-secondary:hover{background:#7f8c8d}
        .section{background:#fff;border-radius:8px;padding:25px;margin-bottom:25px;box-shadow:0 2px 10px rgba(0,0,0,0.1)}
        .section h2{border-bottom:2px solid#ecf0f1;padding-bottom:10px;margin-top:0;color:#2c3e50}
        .form-group{margin-bottom:20px}
        .form-group label{display:block;margin-bottom:8px;font-weight:600}
        .form-control{width:100%;padding:10px;border:1px solid#ddd;border-radius:4px;font-size:16px}
        .form-control:focus{border-color:#3498db;outline:none}
        .checkbox-group{margin-top:10px}
        .checkbox-item{display:flex;align-items:center;margin-bottom:8px}
        .checkbox-item input{margin-right:10px}
        .focus-area{margin-bottom:30px;border:1px solid#eee;padding:15px;border-radius:5px}
        .goal-item{margin-bottom:20px;padding:15px;background:#f8f9fa;border-radius:5px}
        .goal-item h4{margin-top:0}
        .action-item{margin-left:20px;margin-bottom:10px}
        .add-btn{margin-top:10px}
        .remove-btn{background:#e74c3c;margin-left:10px}
        .remove-btn:hover{background:#c0392b}
        .hidden{display:none}
        #summarySection{background:#f8f9fa}
        #exportOptions{text-align:center;margin-top:20px}
        .progress-bar{height:10px;background:#ecf0f1;border-radius:5px;margin-bottom:20px;overflow:hidden}
        .progress{height:100%;background:#2ecc71;width:0%;transition:width .3s}
        .progress-text{text-align:right;color:#7f8c8d;font-size:14px}
        .nav-buttons{display:flex;justify-content:space-between;margin-top:30px}
        @media print{body{background:none}.no-print{display:none}.section{box-shadow:none;page-break-inside:avoid}}
    </style>
</head>
<body>
    <div class="header">
        <h1>School Improvement Plan Generator</h1>
        <p>Create a comprehensive school improvement plan with measurable goals and actionable strategies</p>
        <img alt="School Logo" id="schoolLogoPreview" src="" style="display: none; margin: 10px auto; max-width: 200px;" />
    </div>
    
    <div class="progress-bar">
        <div class="progress" id="formProgress"></div>
    </div>
    <p class="progress-text" id="progressText">0% Complete</p>
    
    <div class="section" id="homeSection">
        <h2>Get Started</h2>
        <p>This tool will guide you through creating a professional School Improvement Plan. Click the button below to begin.</p>
        <div class="form-group">
            <label for="initialLogo">Upload School Logo (Optional)</label>
            <input accept="image/*" class="form-control" id="initialLogo" type="file" />
        </div>
        <button class="btn" id="startBtn">Start Creating Plan</button>
    </div>
    
    <div class="section hidden" id="basicInfoSection">
        <h2>Basic Information</h2>
        <div class="form-group">
            <label for="schoolName">School Name</label>
            <input class="form-control" id="schoolName" required="" type="text" />
        </div>
        <div class="form-group">
            <label for="district">District/Region</label>
            <input class="form-control" id="district" required="" type="text" />
        </div>
        <div class="form-group">
            <label for="year">Year</label>
            <input class="form-control" id="year" required="" type="text" value="2025" />
        </div>
        <div class="form-group">
            <label for="principal">Principal/Head Teacher Name</label>
            <input class="form-control" id="principal" required="" type="text" />
        </div>
        <div class="form-group">
            <label for="contact">Email / Contact Number</label>
            <input class="form-control" id="contact" required="" type="text" />
        </div>
        <div class="form-group">
            <label for="schoolLogo">Upload School Logo</label>
            <input accept="image/*" class="form-control" id="schoolLogo" type="file" />
        </div>
        <div class="form-group">
            <label for="academicLevel">Academic Level</label>
            <select class="form-control" id="academicLevel" required="">
                <option value="">Select Level</option>
                <option value="Primary">Primary</option>
                <option value="Middle">Middle</option>
                <option value="Secondary">Secondary</option>
                <option value="Higher Secondary">Higher Secondary</option>
            </select>
        </div>
        <div class="nav-buttons">
            <button class="btn" id="nextToProfileBtn">Next: School Profile</button>
        </div>
    </div>
    
    <div class="section hidden" id="profileSection">
        <h2>School Profile</h2>
        <div class="form-group">
            <label>Number of Students</label>
            <div style="display: flex; gap: 20px;">
                <div style="flex: 1;">
                    <input class="form-control" id="maleStudents" min="0" placeholder="Boys" type="number" />
                </div>
                <div style="flex: 1;">
                    <input class="form-control" id="femaleStudents" min="0" placeholder="Girls" type="number" />
                </div>
            </div>
        </div>
        <div class="form-group">
            <label>Number of Teachers</label>
            <div style="display: flex; gap: 20px;">
                <div style="flex: 1;">
                    <input class="form-control" id="maleTeachers" min="0" placeholder="Male" type="number" />
                </div>
                <div style="flex: 1;">
                    <input class="form-control" id="femaleTeachers" min="0" placeholder="Female" type="number" />
                </div>
            </div>
        </div>
        <div class="form-group">
            <label for="classrooms">Total Classrooms</label>
            <input class="form-control" id="classrooms" min="0" type="number" />
        </div>
        <div class="form-group">
            <label>Available Facilities</label>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input id="library" name="facilities" type="checkbox" />
                    <label for="library">Library</label>
                </div>
                <div class="checkbox-item">
                    <input id="computerLab" name="facilities" type="checkbox" />
                    <label for="computerLab">Computer Lab</label>
                </div>
                <div class="checkbox-item">
                    <input id="playground" name="facilities" type="checkbox" />
                    <label for="playground">Playground</label>
                </div>
                <div class="checkbox-item">
                    <input id="washrooms" name="facilities" type="checkbox" />
                    <label for="washrooms">Washrooms</label>
                </div>
                <div class="checkbox-item">
                    <input id="scienceLab" name="facilities" type="checkbox" />
                    <label for="scienceLab">Science Lab</label>
                </div>
                <div class="checkbox-item">
                    <input id="cafeteria" name="facilities" type="checkbox" />
                    <label for="cafeteria">Cafeteria</label>
                </div>
            </div>
        </div>
        <div class="form-group">
            <label for="needsAssessment">Needs Assessment</label>
            <select class="form-control" id="needsAssessment" multiple="">
                <option value="Infrastructure">Infrastructure Improvement</option>
                <option value="Teacher Training">Teacher Training</option>
                <option value="Curriculum">Curriculum Development</option>
                <option value="Technology">Technology Integration</option>
                <option value="Student Support">Student Support Services</option>
                <option value="Community Engagement">Community Engagement</option>
                <option value="Safety">Safety Measures</option>
            </select>
        </div>
        <div class="nav-buttons">
            <button class="btn btn-secondary" id="backToBasicBtn">Back</button>
            <button class="btn" id="nextToFocusBtn">Next: Focus Areas</button>
        </div>
    </div>
    
    <div class="section hidden" id="focusSection">
        <h2>Core Focus Areas</h2>
        <p>Define goals, strategies, and success indicators for each focus area.</p>
        <div id="focusAreasContainer">
            <div class="focus-area" data-area="leadership">
                <h3>Leadership &amp; Management</h3>
                <div class="goals-container" id="leadershipGoals"></div>
                <button class="btn add-btn add-goal-btn" data-area="leadership">Add Goal</button>
            </div>
            <div class="focus-area" data-area="teaching">
                <h3>Teaching &amp; Learning</h3>
                <div class="goals-container" id="teachingGoals"></div>
                <button class="btn add-btn add-goal-btn" data-area="teaching">Add Goal</button>
            </div>
            <div class="focus-area" data-area="performance">
                <h3>Student Performance</h3>
                <div class="goals-container" id="performanceGoals"></div>
                <button class="btn add-btn add-goal-btn" data-area="performance">Add Goal</button>
            </div>
            <div class="focus-area" data-area="parental">
                <h3>Parental Involvement</h3>
                <div class="goals-container" id="parentalGoals"></div>
                <button class="btn add-btn add-goal-btn" data-area="parental">Add Goal</button>
            </div>
            <div class="focus-area" data-area="infrastructure">
                <h3>Infrastructure &amp; Resources</h3>
                <div class="goals-container" id="infrastructureGoals"></div>
                <button class="btn add-btn add-goal-btn" data-area="infrastructure">Add Goal</button>
            </div>
            <div class="focus-area" data-area="development">
                <h3>Professional Development</h3>
                <div class="goals-container" id="developmentGoals"></div>
                <button class="btn add-btn add-goal-btn" data-area="development">Add Goal</button>
            </div>
            <div class="focus-area" data-area="inclusive">
                <h3>Inclusive Education</h3>
                <div class="goals-container" id="inclusiveGoals"></div>
                <button class="btn add-btn add-goal-btn" data-area="inclusive">Add Goal</button>
            </div>
            <div class="focus-area" data-area="safety">
                <h3>Safety and Discipline</h3>
                <div class="goals-container" id="safetyGoals"></div>
                <button class="btn add-btn add-goal-btn" data-area="safety">Add Goal</button>
            </div>
        </div>
        <div class="nav-buttons">
            <button class="btn btn-secondary" id="backToProfileBtn">Back</button>
            <button class="btn" id="nextToPriorityBtn">Next: Priorities</button>
        </div>
    </div>
    
    <div class="section hidden" id="prioritySection">
        <h2>Priority Areas and Target Setting</h2>
        <div class="form-group">
            <label>Top 3 Priorities</label>
            <input class="form-control" id="priority1" placeholder="Priority 1" type="text" />
            <input class="form-control" id="priority2" placeholder="Priority 2" style="margin-top: 10px;" type="text" />
            <input class="form-control" id="priority3" placeholder="Priority 3" style="margin-top: 10px;" type="text" />
        </div>
        <div class="form-group">
            <label for="performanceTargets">Performance Targets</label>
            <textarea class="form-control" id="performanceTargets" placeholder="Describe specific measurable targets for improvement" rows="4"></textarea>
        </div>
        <div class="nav-buttons">
            <button class="btn btn-secondary" id="backToFocusBtn">Back</button>
            <button class="btn" id="nextToMonitorBtn">Next: Monitoring</button>
        </div>
    </div>
    
    <div class="section hidden" id="monitorSection">
        <h2>Monitoring &amp; Evaluation</h2>
        <div class="form-group">
            <label for="monitoringTools">Monitoring Tools</label>
            <select class="form-control" id="monitoringTools">
                <option value="">Select Tools</option>
                <option value="Surveys">Surveys</option>
                <option value="Observations">Classroom Observations</option>
                <option value="Tests">Standardized Tests</option>
                <option value="Reports">Progress Reports</option>
                <option value="Meetings">Staff Meetings</option>
            </select>
        </div>
        <div class="form-group">
            <label for="monitoringFrequency">Frequency</label>
            <select class="form-control" id="monitoringFrequency">
                <option value="">Select Frequency</option>
                <option value="Weekly">Weekly</option>
                <option value="Monthly">Monthly</option>
                <option value="Quarterly">Quarterly</option>
                <option value="Semester">Per Semester</option>
                <option value="Annual">Annual</option>
            </select>
        </div>
        <div class="form-group">
            <label>Milestone Tracking</label>
            <div id="milestonesContainer">
                <div class="milestone-item" style="margin-bottom: 10px;">
                    <input class="form-control milestone-name" placeholder="Milestone" style="display: inline-block; width: 60%;" type="text" />
                    <select class="form-control milestone-status" style="display: inline-block; margin-left: 10px; width: 30%;">
                        <option value="On track">On track</option>
                        <option value="Delayed">Delayed</option>
                        <option value="Completed">Completed</option>
                    </select>
                </div>
            </div>
            <button class="btn add-btn" id="addMilestoneBtn">Add Milestone</button>
        </div>
        <div class="nav-buttons">
            <button class="btn btn-secondary" id="backToPriorityBtn">Back</button>
            <button class="btn" id="generatePlanBtn">Generate Plan</button>
        </div>
    </div>
    
    <div class="section hidden" id="summarySection">
        <h2>School Improvement Plan Summary</h2>
        <div id="planSummary"></div>
        <div id="exportOptions" class="no-print">
            <button class="btn" id="exportPdfBtn">Download PDF</button>
            <button class="btn" id="exportDocxBtn">Download DOCX</button>
            <button class="btn" id="printPlanBtn">Print Plan</button>
            <button class="btn btn-secondary" id="editPlanBtn">Edit Plan</button>
        </div>
    </div>

    <script>
        // Initialize jsPDF
        const { jsPDF } = window.jspdf;
        
        document.addEventListener('DOMContentLoaded', function() {
            const sections = ['home', 'basicInfo', 'profile', 'focus', 'priority', 'monitor', 'summary'];
            let currentSection = 0;
            
            // Update progress bar
            const updateProgress = () => {
                const progress = Math.floor((currentSection / (sections.length - 1)) * 100;
                document.getElementById('formProgress').style.width = progress + '%';
                document.getElementById('progressText').textContent = progress + '% Complete';
            };
            
            // Show specific section
            const showSection = (index) => {
                sections.forEach((section, i) => {
                    const el = document.getElementById(section + 'Section');
                    if (i === index) {
                        el.classList.remove('hidden');
                        currentSection = index;
                    } else {
                        el.classList.add('hidden');
                    }
                });
                updateProgress();
            };
            
            // Navigation event listeners
            document.getElementById('startBtn').addEventListener('click', (e) => {
                e.preventDefault();
                showSection(1);
            });
            document.getElementById('nextToProfileBtn').addEventListener('click', (e) => {
                e.preventDefault();
                showSection(2);
            });
            document.getElementById('nextToFocusBtn').addEventListener('click', (e) => {
                e.preventDefault();
                showSection(3);
            });
            document.getElementById('nextToPriorityBtn').addEventListener('click', (e) => {
                e.preventDefault();
                showSection(4);
            });
            document.getElementById('nextToMonitorBtn').addEventListener('click', (e) => {
                e.preventDefault();
                showSection(5);
            });
            document.getElementById('backToBasicBtn').addEventListener('click', (e) => {
                e.preventDefault();
                showSection(1);
            });
            document.getElementById('backToProfileBtn').addEventListener('click', (e) => {
                e.preventDefault();
                showSection(2);
            });
            document.getElementById('backToFocusBtn').addEventListener('click', (e) => {
                e.preventDefault();
                showSection(3);
            });
            document.getElementById('backToPriorityBtn').addEventListener('click', (e) => {
                e.preventDefault();
                showSection(4);
            });
            document.getElementById('generatePlanBtn').addEventListener('click', (e) => {
                e.preventDefault();
                generateSummary();
                showSection(6);
            });
            document.getElementById('editPlanBtn').addEventListener('click', (e) => {
                e.preventDefault();
                showSection(1);
            });
            document.getElementById('printPlanBtn').addEventListener('click', (e) => {
                e.preventDefault();
                window.print();
            });
            
            // Logo upload handling
            const initialLogo = document.getElementById('initialLogo');
            const schoolLogo = document.getElementById('schoolLogo');
            const logoPreview = document.getElementById('schoolLogoPreview');
            
            const handleLogoUpload = (input, preview) => {
                input.addEventListener('change', function(e) {
                    if (e.target.files && e.target.files[0]) {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            preview.src = event.target.result;
                            preview.style.display = 'block';
                        };
                        reader.readAsDataURL(e.target.files[0]);
                    }
                });
            };
            
            handleLogoUpload(initialLogo, logoPreview);
            handleLogoUpload(schoolLogo, logoPreview);
            
            // Goal and action management
            document.querySelectorAll('.add-goal-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const area = this.getAttribute('data-area');
                    addGoal(area);
                });
            });
            
            document.getElementById('addMilestoneBtn').addEventListener('click', addMilestone);
            
            function addGoal(area) {
                const container = document.getElementById(area + 'Goals');
                const goalId = 'goal_' + area + '_' + Date.now();
                const goalHtml = `
                    <div class="goal-item" id="${goalId}">
                        <h4>Goal</h4>
                        <input type="text" class="form-control goal-title" placeholder="Enter SMART goal">
                        <div class="form-group">
                            <label>Strategy</label>
                            <textarea class="form-control goal-strategy" placeholder="Describe strategies to achieve this goal"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Indicator/Success Criteria</label>
                            <input type="text" class="form-control goal-indicator" placeholder="How will you measure success?">
                        </div>
                        <div class="form-group">
                            <label>Responsible Person</label>
                            <input type="text" class="form-control goal-responsible" placeholder="Who will be responsible?">
                        </div>
                        <div class="form-group">
                            <label>Timeline</label>
                            <input type="text" class="form-control goal-timeline" placeholder="Expected completion date">
                        </div>
                        <div class="actions-container"></div>
                        <button class="btn add-btn add-action-btn" data-goal="${goalId}">Add Action</button>
                        <button class="btn remove-btn remove-goal-btn">Remove Goal</button>
                    </div>
                `;
                container.insertAdjacentHTML('beforeend', goalHtml);
                
                document.querySelector(`#${goalId} .add-action-btn`).addEventListener('click', function() {
                    addAction(this.getAttribute('data-goal'));
                });
                
                document.querySelector(`#${goalId} .remove-goal-btn`).addEventListener('click', function() {
                    container.removeChild(this.parentNode);
                });
            }
            
            function addAction(goalId) {
                const container = document.querySelector(`#${goalId} .actions-container`);
                const actionHtml = `
                    <div class="action-item">
                        <input type="text" class="form-control action-desc" placeholder="Action step">
                        <button class="btn remove-btn remove-action-btn">Remove</button>
                    </div>
                `;
                container.insertAdjacentHTML('beforeend', actionHtml);
                container.lastElementChild.querySelector('.remove-action-btn').addEventListener('click', function() {
                    container.removeChild(this.parentNode);
                });
            }
            
            function addMilestone() {
                const container = document.getElementById('milestonesContainer');
                const milestoneHtml = `
                    <div class="milestone-item" style="margin-bottom:10px">
                        <input type="text" class="form-control milestone-name" placeholder="Milestone" style="display:inline-block;width:60%">
                        <select class="form-control milestone-status" style="display:inline-block;width:30%;margin-left:10px">
                            <option value="On track">On track</option>
                            <option value="Delayed">Delayed</option>
                            <option value="Completed">Completed</option>
                        </select>
                        <button class="btn remove-btn remove-milestone-btn" style="display:inline-block;margin-left:10px">Remove</button>
                    </div>
                `;
                container.insertAdjacentHTML('beforeend', milestoneHtml);
                container.lastElementChild.querySelector('.remove-milestone-btn').addEventListener('click', function() {
                    container.removeChild(this.parentNode);
                });
            }
            
            // Generate the summary view
            function generateSummary() {
                let summaryHtml = `
                    <div style="text-align:center;margin-bottom:30px">
                        <img src="${logoPreview.src}" style="max-height:100px;${logoPreview.style.display === 'none' ? 'display:none' : ''}">
                        <h1>${document.getElementById('schoolName').value || 'School Name'}</h1>
                        <h2>School Improvement Plan ${document.getElementById('year').value || ''}</h2>
                    </div>
                    
                    <h3 style="border-bottom:1px solid #ddd;padding-bottom:5px">Basic Information</h3>
                    <table style="width:100%;margin-bottom:20px">
                        <tr>
                            <td style="width:30%;font-weight:bold">District/Region:</td>
                            <td>${document.getElementById('district').value || ''}</td>
                        </tr>
                        <tr>
                            <td style="font-weight:bold">Principal/Head Teacher:</td>
                            <td>${document.getElementById('principal').value || ''}</td>
                        </tr>
                        <tr>
                            <td style="font-weight:bold">Contact:</td>
                            <td>${document.getElementById('contact').value || ''}</td>
                        </tr>
                        <tr>
                            <td style="font-weight:bold">Academic Level:</td>
                            <td>${document.getElementById('academicLevel').value || ''}</td>
                        </tr>
                    </table>
                    
                    <h3 style="border-bottom:1px solid #ddd;padding-bottom:5px">School Profile</h3>
                    <table style="width:100%;margin-bottom:20px">
                        <tr>
                            <td style="width:30%;font-weight:bold">Number of Students:</td>
                            <td>Boys: ${document.getElementById('maleStudents').value || 0}, Girls: ${document.getElementById('femaleStudents').value || 0}</td>
                        </tr>
                        <tr>
                            <td style="font-weight:bold">Number of Teachers:</td>
                            <td>Male: ${document.getElementById('maleTeachers').value || 0}, Female: ${document.getElementById('femaleTeachers').value || 0}</td>
                        </tr>
                        <tr>
                            <td style="font-weight:bold">Total Classrooms:</td>
                            <td>${document.getElementById('classrooms').value || 0}</td>
                        </tr>
                        <tr>
                            <td style="font-weight:bold">Available Facilities:</td>
                            <td>${Array.from(document.querySelectorAll('input[name="facilities"]:checked')).map(cb => cb.nextElementSibling.textContent).join(', ') || 'None listed'}</td>
                        </tr>
                        <tr>
                            <td style="font-weight:bold">Identified Needs:</td>
                            <td>${Array.from(document.getElementById('needsAssessment').selectedOptions).map(opt => opt.value).join(', ') || 'None selected'}</td>
                        </tr>
                    </table>
                `;
                
                // Focus areas
                const focusAreas = ['leadership', 'teaching', 'performance', 'parental', 'infrastructure', 'development', 'inclusive', 'safety'];
                const areaTitles = {
                    'leadership': 'Leadership & Management',
                    'teaching': 'Teaching & Learning',
                    'performance': 'Student Performance',
                    'parental': 'Parental Involvement',
                    'infrastructure': 'Infrastructure & Resources',
                    'development': 'Professional Development',
                    'inclusive': 'Inclusive Education',
                    'safety': 'Safety and Discipline'
                };
                
                focusAreas.forEach(area => {
                    const goalsContainer = document.getElementById(area + 'Goals');
                    if (goalsContainer.children.length > 0) {
                        summaryHtml += `<h3 style="border-bottom:1px solid #ddd;padding-bottom:5px;page-break-before:always">${areaTitles[area]}</h3>`;
                        
                        Array.from(goalsContainer.children).forEach((goalEl, i) => {
                            summaryHtml += `
                                <div style="margin-bottom:20px">
                                    <h4>Goal ${i + 1}: ${goalEl.querySelector('.goal-title').value || 'No title'}</h4>
                                    <p><strong>Strategy:</strong> ${goalEl.querySelector('.goal-strategy').value || 'Not specified'}</p>
                                    <p><strong>Success Indicator:</strong> ${goalEl.querySelector('.goal-indicator').value || 'Not specified'}</p>
                                    <p><strong>Responsible Person:</strong> ${goalEl.querySelector('.goal-responsible').value || 'Not specified'}</p>
                                    <p><strong>Timeline:</strong> ${goalEl.querySelector('.goal-timeline').value || 'Not specified'}</p>
                            `;
                            
                            const actions = goalEl.querySelectorAll('.action-desc');
                            if (actions.length > 0) {
                                summaryHtml += `<p><strong>Action Steps:</strong><ol>`;
                                actions.forEach(action => {
                                    summaryHtml += `<li>${action.value || 'No description'}</li>`;
                                });
                                summaryHtml += `</ol></p>`;
                            }
                            
                            summaryHtml += `</div>`;
                        });
                    }
                });
                
                // Priorities
                summaryHtml += `
                    <h3 style="border-bottom:1px solid #ddd;padding-bottom:5px;page-break-before:always">Priority Areas</h3>
                    <ol>
                `;
                
                ['priority1', 'priority2', 'priority3'].forEach(id => {
                    const val = document.getElementById(id).value;
                    if (val) summaryHtml += `<li>${val}</li>`;
                });
                
                summaryHtml += `
                    </ol>
                    <h4>Performance Targets</h4>
                    <p>${document.getElementById('performanceTargets').value || 'No targets specified'}</p>
                    
                    <h3 style="border-bottom:1px solid #ddd;padding-bottom:5px;page-break-before:always">Monitoring & Evaluation</h3>
                    <p><strong>Monitoring Tools:</strong> ${document.getElementById('monitoringTools').value || 'Not specified'}</p>
                    <p><strong>Frequency:</strong> ${document.getElementById('monitoringFrequency').value || 'Not specified'}</p>
                `;
                
                // Milestones
                const milestones = document.querySelectorAll('.milestone-name');
                if (milestones.length > 0) {
                    summaryHtml += `
                        <h4>Milestones</h4>
                        <table style="width:100%;border-collapse:collapse">
                            <tr>
                                <th style="text-align:left;padding:8px;border-bottom:1px solid #ddd">Milestone</th>
                                <th style="text-align:left;padding:8px;border-bottom:1px solid #ddd">Status</th>
                            </tr>
                    `;
                    
                    milestones.forEach((milestone, i) => {
                        summaryHtml += `
                            <tr>
                                <td style="padding:8px;border-bottom:1px solid #ddd">${milestone.value || 'No name'}</td>
                                <td style="padding:8px;border-bottom:1px solid #ddd">${document.querySelectorAll('.milestone-status')[i].value || 'Not specified'}</td>
                            </tr>
                        `;
                    });
                    
                    summaryHtml += `</table>`;
                }
                
                document.getElementById('planSummary').innerHTML = summaryHtml;
            }
            
            // Export functionality
            document.getElementById('exportPdfBtn').addEventListener('click', exportToPdf);
            document.getElementById('exportDocxBtn').addEventListener('click', exportToDocx);
            
            function exportToPdf() {
                try {
                    const doc = new jsPDF();
                    
                    // Add school name and title
                    doc.setFontSize(20);
                    doc.text(document.getElementById('schoolName').value || 'School Improvement Plan', 105, 20, { align: 'center' });
                    doc.setFontSize(16);
                    doc.text(`School Improvement Plan ${document.getElementById('year').value || ''}`, 105, 30, { align: 'center' });
                    
                    // Add content from summary
                    const summaryContent = document.getElementById('planSummary').innerText;
                    
                    // Split the content into pages
                    doc.setFontSize(12);
                    const lines = doc.splitTextToSize(summaryContent, 180);
                    let y = 50;
                    
                    for (let i = 0; i < lines.length; i++) {
                        if (y > 280) { // Near the bottom of the page
                            doc.addPage();
                            y = 20;
                        }
                        doc.text(lines[i], 15, y);
                        y += 7;
                    }
                    
                    doc.save('School_Improvement_Plan.pdf');
                } catch (error) {
                    console.error('Error generating PDF:', error);
                    alert('Error generating PDF. Please try again.');
                }
            }
            
            function exportToDocx() {
                try {
                    // Create a new Document
                    const doc = new docx.Document({
                        sections: [{
                            properties: {},
                            children: [
                                new docx.Paragraph({
                                    children: [
                                        new docx.TextRun({
                                            text: document.getElementById('schoolName').value || "School Improvement Plan",
                                            bold: true,
                                            size: 28
                                        })
                                    ],
                                    alignment: docx.AlignmentType.CENTER,
                                    spacing: { after: 200 }
                                }),
                                new docx.Paragraph({
                                    children: [
                                        new docx.TextRun({
                                            text: `Year: ${document.getElementById('year').value || ''}`,
                                            bold: true,
                                            size: 22
                                        })
                                    ],
                                    alignment: docx.AlignmentType.CENTER,
                                    spacing: { after: 300 }
                                })
                            ]
                        }]
                    });

                    // Add content from summary
                    const summaryContent = document.getElementById('planSummary').innerText;
                    const paragraphs = summaryContent.split('\n\n');
                    
                    paragraphs.forEach(para => {
                        if (para.trim()) {
                            // Check if paragraph is a heading
                            if (para.match(/^Basic Information|School Profile|Leadership & Management|Teaching & Learning|Student Performance|Parental Involvement|Infrastructure & Resources|Professional Development|Inclusive Education|Safety and Discipline|Priority Areas|Monitoring & Evaluation/)) {
                                doc.addSection({
                                    children: [
                                        new docx.Paragraph({
                                            text: para,
                                            heading: docx.HeadingLevel.HEADING_2,
                                            spacing: { after: 200 }
                                        })
                                    ]
                                });
                            } 
                            // Check if paragraph is a subheading
                            else if (para.match(/^Goal \d+:|Performance Targets|Milestones/)) {
                                doc.addSection({
                                    children: [
                                        new docx.Paragraph({
                                            text: para,
                                            heading: docx.HeadingLevel.HEADING_3,
                                            spacing: { after: 150 }
                                        })
                                    ]
                                });
                            }
                            // Regular paragraph
                            else {
                                doc.addSection({
                                    children: [
                                        new docx.Paragraph({
                                            text: para,
                                            spacing: { after: 100 }
                                        })
                                    ]
                                });
                            }
                        }
                    });

                    // Generate the DOCX file
                    docx.Packer.toBlob(doc).then(blob => {
                        const link = document.createElement('a');
                        link.href = URL.createObjectURL(blob);
                        link.download = 'School_Improvement_Plan.docx';
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                        URL.revokeObjectURL(link.href);
                    });
                } catch (error) {
                    console.error('Error generating DOCX:', error);
                    alert('Error generating DOCX document. Please try again.');
                }
            }
        });
    </script>
</body>
</html>