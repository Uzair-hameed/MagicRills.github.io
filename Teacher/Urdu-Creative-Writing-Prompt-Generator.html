<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اردو تخلیقی تحریر کا محرک جنریٹر | MagicRills.com</title>
    <link href="https://fonts.googleapis.com/css2?family=Jameel+Noori+Nastaleeq&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #8e44ad;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #f9f9f9;
            --dark: #2c3e50;
            --success: #2ecc71;
            --warning: #f39c12;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Jameel Noori Nastaleeq', serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
            direction: rtl;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            box-shadow: var(--shadow);
        }

        h1 {
            color: var(--primary);
            font-size: 2.8rem;
            margin-bottom: 10px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
        }

        .subtitle {
            font-size: 1.4rem;
            color: var(--secondary);
            margin-bottom: 15px;
        }

        .logo {
            font-weight: bold;
            color: var(--accent);
            font-size: 1.5rem;
        }

        .dashboard {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
        }

        .selection-panel {
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 15px;
            box-shadow: var(--shadow);
        }

        .prompt-display {
            background: rgba(255, 255, 255, 0.9);
            padding: 30px;
            border-radius: 15px;
            box-shadow: var(--shadow);
            min-height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--dark);
            font-size: 1.2rem;
        }

        select, button {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-family: 'Jameel Noori Nastaleeq', serif;
            font-size: 1.1rem;
            background-color: white;
            transition: var(--transition);
        }

        select:focus {
            border-color: var(--secondary);
            outline: none;
        }

        button {
            background-color: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
            margin-top: 10px;
        }

        button:hover {
            background-color: #7d3c98;
            transform: translateY(-2px);
        }

        .secondary-btn {
            background-color: var(--secondary);
        }

        .secondary-btn:hover {
            background-color: #2980b9;
        }

        .accent-btn {
            background-color: var(--accent);
        }

        .accent-btn:hover {
            background-color: #c0392b;
        }

        .prompt-text {
            font-size: 1.8rem;
            line-height: 1.8;
            text-align: center;
            margin-bottom: 20px;
            color: var(--dark);
            min-height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px;
        }

        .actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .actions button {
            flex: 1;
            min-width: 120px;
        }

        .favorites-section {
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 15px;
            box-shadow: var(--shadow);
            margin-top: 20px;
        }

        .favorites-list {
            list-style: none;
            margin-top: 15px;
        }

        .favorite-item {
            padding: 10px 15px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 4px solid var(--primary);
        }

        .favorite-text {
            font-size: 1.2rem;
        }

        .remove-btn {
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 0.9rem;
            width: auto;
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            background: var(--dark);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow);
            z-index: 100;
        }

        footer {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            color: var(--dark);
            font-size: 0.9rem;
        }

        /* Dark theme */
        body.dark-theme {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: #ecf0f1;
        }

        body.dark-theme header,
        body.dark-theme .selection-panel,
        body.dark-theme .prompt-display,
        body.dark-theme .favorites-section {
            background: rgba(44, 62, 80, 0.9);
            color: #ecf0f1;
        }

        body.dark-theme select,
        body.dark-theme .favorite-item {
            background: #34495e;
            color: #ecf0f1;
            border-color: #4a6572;
        }

        body.dark-theme label {
            color: #ecf0f1;
        }

        /* Animation for new prompts */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        /* Step indicator */
        .step-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .step {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 10px;
            font-weight: bold;
        }

        .step.active {
            background: var(--primary);
            color: white;
        }

        /* Download options */
        .download-options {
            display: none;
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .download-options.active {
            display: block;
        }

        /* Progress bar */
        .progress-bar {
            height: 5px;
            background: #eee;
            border-radius: 5px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.5s ease;
        }
    </style>
</head>
<body>
    <button class="theme-toggle" id="themeToggle">🌙</button>
    
    <div class="container">
        <header>
            <h1>اردو تخلیقی تحریر کا محرک جنریٹر</h1>
            <p class="subtitle">اپنی تخلیقی صلاحیتوں کو نئے موضوعات سے جگائیں</p>
            <p class="logo">MagicRills.com</p>
        </header>

        <div class="step-indicator">
            <div class="step active">1</div>
            <div class="step">2</div>
            <div class="step">3</div>
        </div>

        <div class="progress-bar">
            <div class="progress" id="progressBar"></div>
        </div>

        <div class="dashboard">
            <div class="selection-panel">
                <div class="form-group">
                    <label for="area">شعبہ منتخب کریں:</label>
                    <select id="area">
                        <option value="">-- شعبہ منتخب کریں --</option>
                        <option value="literature">ادب</option>
                        <option value="grammar">قواعد و گرامر</option>
                        <option value="creative">تخلیقی تحریر</option>
                        <option value="academic">تعلیمی تحریر</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="category">صنف منتخب کریں:</label>
                    <select id="category" disabled>
                        <option value="">-- پہلے شعبہ منتخب کریں --</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="type">تحریر کی قسم:</label>
                    <select id="type" disabled>
                        <option value="">-- پہلے صنف منتخب کریں --</option>
                    </select>
                </div>

                <button id="generateBtn" disabled>نیا محرک جنریٹ کریں</button>
                <button id="saveBtn" class="secondary-btn" disabled>پسندیدہ میں محفوظ کریں</button>
            </div>

            <div class="prompt-display">
                <div class="prompt-text" id="promptText">
                    براہ کرم شعبہ، صنف اور قسم منتخب کریں
                </div>
                <div class="actions">
                    <button id="copyBtn" disabled>محرک کو کاپی کریں</button>
                    <button id="shareBtn" class="secondary-btn" disabled>شیئر کریں</button>
                    <button id="downloadBtn" class="accent-btn" disabled>ڈاؤن لوڈ کریں</button>
                </div>
                
                <div class="download-options" id="downloadOptions">
                    <h3>ڈاؤن لوڈ کی قسم منتخب کریں:</h3>
                    <div class="actions">
                        <button id="downloadWord" class="secondary-btn">MS Word</button>
                        <button id="downloadPDF" class="accent-btn">PDF</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="favorites-section">
            <h2>میرے پسندیدہ محرکات</h2>
            <ul class="favorites-list" id="favoritesList">
                <!-- Favorites will be added here dynamically -->
            </ul>
        </div>

        <footer>
            <p>یہ ٹول MagicRills.com کے لیے تیار کیا گیا ہے</p>
            <p>© 2023 - تمام حقوق محفوظ ہیں</p>
        </footer>
    </div>

    <!-- Include required libraries for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <script>
        // Urdu writing prompts database with expanded categories
        const prompts = {
            // Literature area
            literature: {
                ghazal: {
                    poetry: [
                        "غم دوراں کا احساں رکھنا، دل کو بہلانا بھول نہ جانا",
                        "کٹے گی شب ہجر تو دن بھی کٹ جائیں گے، یونہی سہارا دے کر ہمیں تنہا نہ چھوڑنا",
                        "دل کی دھڑکن بن کے رہ گئے ہو تم، اب کسی اور کو دھڑکنا سکھا دو",
                        "رات کے سناٹے میں تیری یاد ستاتی ہے، چاند بھی تیرے بغیر اداس لگتا ہے"
                    ],
                    themes: [
                        "عشق و محبت کی نازک کیفیات پر غزل لکھیں",
                        "ہجر و فراق کے جذبات کو غزل کے انداز میں بیان کریں",
                        "فطرت کے حسن کو غزل کی زینت بنائیں",
                        "زندگی کے تلخ تجربات کو غزل کے پیرائے میں ڈھالیں"
                    ],
                    structures: [
                        "مطلع اور مقطع کے درمیان ربط قائم کرتے ہوئے غزل لکھیں",
                        "ردیف و قافیہ کی پابندی کرتے ہوئے غزل تشکیل دیں",
                        "بحر متقارب میں ایک غزل لکھیں",
                        "خود ساختہ بحر میں غزل لکھنے کی کوشش کریں"
                    ]
                },
                nazm: {
                    poetry: [
                        "یہ شہر دھواں دھواں، یہ لوگ بے زباں، کہاں گئی وہ بات چیت کی رعنائی",
                        "دریا کے کنارے کھڑے ہو کر سوچتا ہوں، کیا زندگی بھی دریا کی مانند بہتی چلی جاتی ہے",
                        "ماں کی محبت کو الفاظ میں کیسے سمیٹوں، یہ تو وہ احساس ہے جو دل میں اتر جاتا ہے",
                        "وطن کی محبت نے دیوانہ بنا رکھا ہے، ہر پتھر سے دل لگایا ہے ہر کنکر کو چنا ہے"
                    ],
                    themes: [
                        "معاشرتی مسائل پر ایک نظم تخلیق کریں",
                        "قومی یکجہتی کو موضوع بناتے ہوئے نظم لکھیں",
                        "ماں کی محبت پر ایک طویل نظم لکھیں",
                        "فطرت کے حسن کو نظم کا موضوع بنائیں"
                    ],
                    structures: [
                        "آزاد نظم کے انداز میں اپنے جذبات کا اظہار کریں",
                        "معری نظم لکھنے کی کوشش کریں",
                        "مخصوص بحر میں ایک نظم تشکیل دیں",
                        "نظم میں تمثیلی انداز اپنائیں"
                    ]
                },
                afsana: {
                    short_story: [
                        "وہ پرانی کوٹھی جس کے بارے میں لوگ کہتے تھے کہ وہ جنوں سے بھری پڑی ہے...",
                        "ٹرین کا سفر، ایک اجنبی ساتھی، اور ایک ایسی کہانی جو زندگی بدل دے...",
                        "پرانی لائبریری کی الماری میں چھپا ایک خط جو کئی رازوں سے پردہ اٹھاتا ہے...",
                        "بارش کی ایک رات، بجلی کا گرنا، اور پھر دروازے پر دستک...",
                        "بچپن کا وہ دوست جسے برسوں بعد دوبارہ ملنا اور پتہ چلنا کہ وہ اب وہی نہیں رہا..."
                    ],
                    characters: [
                        "ایک ایسے کردار کی کہانی لکھیں جو معاشرے سے کٹ کر رہتا ہے",
                        "دو متضاد کرداروں کے درمیان تعلقات پر افسانہ تخلیق کریں",
                        "ایک ایسے بچے کی کہانی لکھیں جس کی معصوم آنکھیں دنیا کو مختلف انداز سے دیکھتی ہیں",
                        "خواتین کے مسائل کو اجاگر کرتی ہوئی افسانوی کہانی لکھیں"
                    ],
                    settings: [
                        "کسی پراسرار گاؤں کی کہانی لکھیں جہاں عجیب و غریب واقعات رونما ہوتے ہیں",
                        "تاریخی پس منظر میں ایک افسانہ تخلیق کریں",
                        "سائنسی فکشن کے انداز میں ایک افسانہ لکھیں",
                        "کسی خواب کی دنیا میں گم ہو جانے والے کردار کی کہانی"
                    ]
                },
                novel: {
                    openings: [
                        "وہ صبح جب اس نے فیصلہ کیا کہ اب سب کچھ بدل دے گا...",
                        "پرانی ڈائری کے اوراق پلٹتے ہوئے اسے اپنے ماضی کے وہ پنے ملے جو وہ بھول چکا تھا...",
                        "جنگل کے درمیان کھڑے اس پراسرار مکان نے اس کی توجہ اپنی طرف کھینچ لی...",
                        "ٹرین کی کھڑکی سے باہر دیکھتے ہوئے اسے احساس ہوا کہ وہ اپنی منزل سے کوسوں دور جا چکا ہے..."
                    ],
                    plots: [
                        "ایک نوجوان کی خود شناسی کے سفر پر ناول لکھیں",
                        "خاندانی رازوں پر مبنی ناول کا پلاٹ تیار کریں",
                        "محبت، نفرت اور انتقام کے جذبات سے بھرپور ناول کی کہانی بنائیں",
                        "تاریخی واقعات پر مبنی ناول کا خاکہ تیار کریں"
                    ],
                    characters: [
                        "ایک ایسے کردار کو تخلیق کریں جو معاشرتی تبدیلی کا باعث بنے",
                        "کثیر الجہت شخصیت کے حامل مرکزی کردار کی تشکیل کریں",
                        "ایک اینٹی ہیرو کے بارے میں ناول لکھیں",
                        "خواتین کے حقوق کی علمبردار کردار کی کہانی تخلیق کریں"
                    ]
                },
                drama: {
                    dialogues: [
                        "دو بھائیوں کے درمیان وراثت کے تنازعے پر مکالمہ لکھیں",
                        "استاد اور شاگرد کے درمیان تعلیم کی اہمیت پر گفتگو",
                        "ماں بیٹی کے درمیان روایات اور جدیدیت کے تصادم پر بات چیت",
                        "دو دوستوں کے درمیان محبت اور دوستی کے فرق پر مکالمہ"
                    ],
                    scenes: [
                        "ایک ڈرامائی منظر تخلیق کریں جہاں ایک راز فاش ہوتا ہے",
                        "جذباتی اتار چڑھاؤ والا منظر لکھیں",
                        "تاریخی واقعے پر مبنی ڈرامائی منظر نامہ تیار کریں",
                        "کامیڈی کے انداز میں ایک منظر لکھیں"
                    ],
                    themes: [
                        "معاشرتی ناانصافی پر ڈراما لکھیں",
                        "خاندانی مسائل کو ڈرامائی انداز میں پیش کریں",
                        "سیاسی corruption پر طنزیہ ڈراما تخلیق کریں",
                        "نوجوان نسل کے مسائل پر ڈراما لکھیں"
                    ]
                }
            },
            
            // Grammar area
            grammar: {
                ism: {
                    exercises: [
                        "درج ذیل جملوں میں اسم کی اقسام کی نشاندہی کریں",
                        "اسم معرفہ اور اسم نکرہ کی مثالیں دیں",
                        "اسم جمع اور اسم واحد کے درمیان فرق واضح کریں",
                        "اسم کیفیت اور اسم ذاتی کے استعمال پر مشق کریں"
                    ],
                    applications: [
                        "اسم کی مختلف اقسام کو استعمال کرتے ہوئے جملے بنائیں",
                        "اسم صفت اور موصوف کے درمیان مطابقت پیدا کریں",
                        "اسم ظرف کی مدد سے مقام اور زمان کا اظہار کریں",
                        "اسم مشتق اور اسم جامد کی مثالیں دیں"
                    ]
                },
                fail: {
                    exercises: [
                        "فعل کی گردان کی مشق کریں",
                        "فعل ماضی، فعل مضارع اور فعل مستقبل میں فرق واضح کریں",
                        "فعل معروف اور فعل مجہول کے جملے بنائیں",
                        "فعل لازم اور فعل متعدی کی مثالیں دیں"
                    ],
                    applications: [
                        "مختلف اوقات میں فعل کا صحیح استعمال کریں",
                        "فعل امر اور فعل نہی کے جملے بنائیں",
                        "فعل شرطی کے استعمال پر مشق کریں",
                        "فعل کی مختلف اقسام کو استعمال کرتے ہوئے مکالمہ لکھیں"
                    ]
                },
                harf: {
                    exercises: [
                        "حروف جر کی فہرست تیار کریں اور ان کے استعمال کی مشق کریں",
                        "حروف شرط کو جملوں میں استعمال کریں",
                        "حروف نداء کے استعمال پر مشق کریں",
                        "حروف عطف کی مدد سے جملے بنائیں"
                    ],
                    applications: [
                        "حروف جر کو استعمال کرتے ہوئے جملوں کی ساخت کو بہتر بنائیں",
                        "حروف شرط کے ذریعے شرطیہ جملے تشکیل دیں",
                        "حروف نداء کے استعمال سے خطاب کا انداز اپنائیں",
                        "حروف عطف کے ذریعے جملوں میں ربط پیدا کریں"
                    ]
                },
                jumla: {
                    exercises: [
                        "جملہ اسمیہ اور جملہ فعلیہ میں فرق واضح کریں",
                        "جملہ مفید اور جملہ غیر مفید کی مثالیں دیں",
                        "جملہ شرطیہ کی تشکیل پر مشق کریں",
                        "جملہ معترضہ کے استعمال کو سمجھیں"
                    ],
                    applications: [
                        "جملہ اسمیہ اور جملہ فعلیہ کو استعمال کرتے ہوئے پیراگراف لکھیں",
                        "جملہ شرطیہ کے ذریعے شرط و جزا کا اظہار کریں",
                        "جملہ معترضہ کو استعمال کرتے ہوئے تحریر میں تنوع پیدا کریں",
                        "مختلف قسم کے جملوں کو ملا کر ایک مکمل تحریر تشکیل دیں"
                    ]
                }
            },
            
            // Creative Writing area
            creative: {
                khaka: {
                    characters: [
                        "ایک ایسے بزرگ کا خاکہ پیش کریں جنہوں نے پوری زندگی علم کی خدمت میں گزاری ہو",
                        "کسی بچے کا خاکہ لکھیں جس کی معصومیت آپ کو متاثر کرتی ہو",
                        "ایک ہیرو کا خاکہ پیش کریں جو عام زندگی میں کوئی خاص مقام نہ رکھتا ہو",
                        "کسی تاریخی شخصیت کا خاکہ لکھیں"
                    ],
                    scenes: [
                        "بارش کے بعد کے منظر کا خاکہ پیش کریں",
                        "بازار کے ہنگامے کا منظر قلمبند کریں",
                        "ریلویے سٹیشن کے مصروف ترین لمحات کا خاکہ لکھیں",
                        "کسی تہوار کے موقع پر گھر کے ماحول کا خاکہ پیش کریں"
                    ],
                    objects: [
                        "پرانی گھڑی کا خاکہ لکھیں جو نسل در نسل چلی آ رہی ہو",
                        "اپنے پسندیدہ کتاب کے خاکے پیش کریں",
                        "کسی تاریخی عمارت کا خاکہ لکھیں",
                        "فطرت کے کسی پہلو کا خاکہ پیش کریں"
                    ]
                },
                mazmoon: {
                    topics: [
                        "تعلیم نسواں کی اہمیت اور اس کے اثرات",
                        "موبائل فون کے فوائد و نقصانات",
                        "کھیلوں کی اہمیت اور نوجوان نسل پر ان کے اثرات",
                        "ماحولیاتی آلودگی اور اس کے تدارک کے طریقے"
                    ],
                    structures: [
                        "تمہید، متن اور اختتام پر مشتمل مضمون لکھیں",
                        "دلیلوں اور ثبوتوں کے ساتھ ایک مضبوط مضمون تخلیق کریں",
                        "تقابلی جائزہ پر مبنی مضمون لکھیں",
                        "مسئلے اور حل کی شکل میں مضمون تشکیل دیں"
                    ]
                },
                inshaiya: {
                    expressions: [
                        "اپنے پسندیدہ موسم کے بارے میں انشائیہ لکھیں",
                        "کسی یادگار سفر کے تجربے کو انشائیے کی شکل میں پیش کریں",
                        "بچپن کی کسی یاد کو انشائیے کا موضوع بنائیں",
                        "کسی کتاب کے بارے میں اپنے جذبات انشائیے میں بیان کریں"
                    ],
                    styles: [
                        "خود کلامی کے انداز میں انشائیہ لکھیں",
                        "خط کی شکل میں انشائیہ تخلیق کریں",
                        "ڈائری کے اندراج کی طرح انشائیہ لکھیں",
                        "مکالمے کی شکل میں انشائیہ پیش کریں"
                    ]
                },
                travelogue: {
                    places: [
                        "کسی پہاڑی مقام کا سفرنامہ لکھیں",
                        "دریا کے کنارے سیر کا احوال بیان کریں",
                        "تاریخی مقام کی سیر اور اس کے تاثرات",
                        "کسی بیرون ملک سفر کے تجربات قلمبند کریں"
                    ],
                    experiences: [
                        "پہلی ہوائی سفر کا تجربہ بیان کریں",
                        "ٹرین کے سفر میں پیش آنے والے واقعات",
                        "سفر میں ملنے والے مختلف لوگوں کے مشاہدات",
                        "سفر کے دوران پیش آنے والی مشکلات اور ان کا حل"
                    ]
                }
            },
            
            // Academic Writing area
            academic: {
                research: {
                    proposals: [
                        "اردو زبان کے فروغ کے لیے تحقیق کا منصوبہ پیش کریں",
                        "نئی نسل میں مطالعے کے رجحانات پر تحقیق کا خاکہ",
                        "سماجی میڈیا کے اردو ادب پر اثرات کا جائزہ",
                        "عصری تقاضوں اور اردو تعلیم کے درمیان ہم آہنگی کی تحقیق"
                    ],
                    papers: [
                        "اردو شاعری میں جدید رجحانات پر تحقیقی مقالہ لکھیں",
                        "اردو نثر میں نسائی حسیت کا تجزیہ پیش کریں",
                        "عالمی سطح پر اردو زبان کے مقام کا جائزہ",
                        "اردو زبان میں سائنسی اصطلاحات کے استعمال کا تحقیقی مطالعہ"
                    ]
                },
                critique: {
                    books: [
                        "کسی معروف اردو ناول کا تنقیدی جائزہ پیش کریں",
                        "کسی شاعر کے کلام کا تجزیہ کریں",
                        "کسی افسانہ نگار کے اسلوب کا تنقیدی مطالعہ",
                        "کسی ڈراما نویس کے کام کا تجزیہ پیش کریں"
                    ],
                    themes: [
                        "اردو ادب میں قومی یکجہتی کے عناصر کا تجزیہ",
                        "عصری اردو شاعری میں موجودہ دور کے مسائل کی عکاسی",
                        "اردو نثر میں ماحولیاتی شعور کا جائزہ",
                        "اردو ادب میں خواتین کے مسائل کی نمائندگی کا تنقیدی مطالعہ"
                    ]
                },
                analysis: {
                    literary: [
                        "کسی ادبی تحریک کا تجزیہ پیش کریں",
                        "کسی مصنف کے اسلوب کی خصوصیات کا جائزہ لیں",
                        "ادبی تنقید کے مختلف اسکولوں کا تقابلی جائزہ",
                        "کسی ادبی صنف کے ارتقاء کا تجزیہ کریں"
                    ],
                    linguistic: [
                        "اردو زبان کے ارتقائی مراحل کا تجزیہ",
                        "اردو کے لہجوں میں فرق اور ان کی خصوصیات",
                        "اردو املا کے مسائل اور ان کا تجزیہ",
                        "اردو قواعد کے ارتقاء کا جائزہ"
                    ]
                }
            }
        };

        // DOM elements
        const areaSelect = document.getElementById('area');
        const categorySelect = document.getElementById('category');
        const typeSelect = document.getElementById('type');
        const generateBtn = document.getElementById('generateBtn');
        const saveBtn = document.getElementById('saveBtn');
        const promptText = document.getElementById('promptText');
        const copyBtn = document.getElementById('copyBtn');
        const shareBtn = document.getElementById('shareBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const downloadOptions = document.getElementById('downloadOptions');
        const downloadWord = document.getElementById('downloadWord');
        const downloadPDF = document.getElementById('downloadPDF');
        const favoritesList = document.getElementById('favoritesList');
        const themeToggle = document.getElementById('themeToggle');
        const progressBar = document.getElementById('progressBar');
        const steps = document.querySelectorAll('.step');

        // Current prompt and state
        let currentPrompt = '';
        let currentArea = '';
        let currentCategory = '';
        let currentType = '';

        // Update categories based on selected area
        areaSelect.addEventListener('change', function() {
            const area = this.value;
            currentArea = area;
            
            if (area) {
                categorySelect.disabled = false;
                categorySelect.innerHTML = '<option value="">-- صنف منتخب کریں --</option>';
                
                // Populate categories based on area
                const categories = Object.keys(prompts[area] || {});
                categories.forEach(cat => {
                    const option = document.createElement('option');
                    option.value = cat;
                    
                    // Convert category key to Urdu label
                    let urduLabel = '';
                    switch(cat) {
                        case 'ghazal': urduLabel = 'غزل'; break;
                        case 'nazm': urduLabel = 'نظم'; break;
                        case 'afsana': urduLabel = 'افسانہ'; break;
                        case 'novel': urduLabel = 'ناول'; break;
                        case 'drama': urduLabel = 'ڈراما'; break;
                        case 'ism': urduLabel = 'اسم'; break;
                        case 'fail': urduLabel = 'فعل'; break;
                        case 'harf': urduLabel = 'حرف'; break;
                        case 'jumla': urduLabel = 'جملہ'; break;
                        case 'khaka': urduLabel = 'خاکہ'; break;
                        case 'mazmoon': urduLabel = 'مضمون'; break;
                        case 'inshaiya': urduLabel = 'انشائیہ'; break;
                        case 'travelogue': urduLabel = 'سفرنامہ'; break;
                        case 'research': urduLabel = 'تحقیق'; break;
                        case 'critique': urduLabel = 'تنقید'; break;
                        case 'analysis': urduLabel = 'تجزیہ'; break;
                        default: urduLabel = cat;
                    }
                    
                    option.textContent = urduLabel;
                    categorySelect.appendChild(option);
                });
                
                // Reset type selection
                typeSelect.disabled = true;
                typeSelect.innerHTML = '<option value="">-- پہلے صنف منتخب کریں --</option>';
                
                // Update progress
                updateProgress(1);
            } else {
                categorySelect.disabled = true;
                typeSelect.disabled = true;
                generateBtn.disabled = true;
                updateProgress(0);
            }
            
            // Reset action buttons
            resetActionButtons();
        });

        // Update types based on selected category
        categorySelect.addEventListener('change', function() {
            const area = areaSelect.value;
            const category = this.value;
            currentCategory = category;
            
            if (area && category) {
                typeSelect.disabled = false;
                typeSelect.innerHTML = '<option value="">-- قسم منتخب کریں --</option>';
                
                // Populate types based on category
                const types = Object.keys(prompts[area][category] || {});
                types.forEach(type => {
                    const option = document.createElement('option');
                    option.value = type;
                    
                    // Convert type key to Urdu label
                    let urduLabel = '';
                    switch(type) {
                        case 'poetry': urduLabel = 'شاعری'; break;
                        case 'themes': urduLabel = 'موضوعات'; break;
                        case 'structures': urduLabel = 'اسلوب'; break;
                        case 'short_story': urduLabel = 'افسانہ'; break;
                        case 'characters': urduLabel = 'کردار'; break;
                        case 'settings': urduLabel = 'ترتیب'; break;
                        case 'openings': urduLabel = 'آغاز'; break;
                        case 'plots': urduLabel = 'پلاٹ'; break;
                        case 'dialogues': urduLabel = 'مکالمہ'; break;
                        case 'scenes': urduLabel = 'مناظر'; break;
                        case 'exercises': urduLabel = 'مشق'; break;
                        case 'applications': urduLabel = 'عملی استعمال'; break;
                        case 'expressions': urduLabel = 'اظہار'; break;
                        case 'styles': urduLabel = 'اسلوب'; break;
                        case 'places': urduLabel = 'مقامات'; break;
                        case 'experiences': urduLabel = 'تجربات'; break;
                        case 'proposals': urduLabel = 'منصوبہ جات'; break;
                        case 'papers': urduLabel = 'تحقیقی مقالہ جات'; break;
                        case 'books': urduLabel = 'کتب'; break;
                        case 'literary': urduLabel = 'ادبی'; break;
                        case 'linguistic': urduLabel = 'لسانی'; break;
                        default: urduLabel = type;
                    }
                    
                    option.textContent = urduLabel;
                    typeSelect.appendChild(option);
                });
                
                // Update progress
                updateProgress(2);
            } else {
                typeSelect.disabled = true;
                generateBtn.disabled = true;
                updateProgress(1);
            }
            
            // Reset action buttons
            resetActionButtons();
        });

        // Enable generate button when type is selected
        typeSelect.addEventListener('change', function() {
            currentType = this.value;
            if (this.value) {
                generateBtn.disabled = false;
                updateProgress(3);
            } else {
                generateBtn.disabled = true;
                updateProgress(2);
            }
            
            // Reset action buttons
            resetActionButtons();
        });

        // Generate a new prompt
        function generatePrompt() {
            const area = areaSelect.value;
            const category = categorySelect.value;
            const type = typeSelect.value;
            
            if (!area || !category || !type) {
                promptText.textContent = 'براہ کرم شعبہ، صنف اور قسم منتخب کریں';
                return;
            }
            
            const availablePrompts = prompts[area]?.[category]?.[type] || [];
            
            if (availablePrompts.length === 0) {
                promptText.textContent = 'اس قسم کے لیے کوئی محرک دستیاب نہیں ہے۔ براہ کرم دوسری قسم منتخب کریں۔';
                return;
            }
            
            const randomIndex = Math.floor(Math.random() * availablePrompts.length);
            currentPrompt = availablePrompts[randomIndex];
            
            // Add fade-in animation
            promptText.classList.remove('fade-in');
            void promptText.offsetWidth; // Trigger reflow
            promptText.classList.add('fade-in');
            
            promptText.textContent = currentPrompt;
            
            // Enable action buttons
            copyBtn.disabled = false;
            shareBtn.disabled = false;
            saveBtn.disabled = false;
            downloadBtn.disabled = false;
            
            // Hide download options
            downloadOptions.classList.remove('active');
        }

        // Save current prompt to favorites
        function saveToFavorites() {
            if (!currentPrompt) {
                alert('براہ کرم پہلے ایک محرک جنریٹ کریں۔');
                return;
            }
            
            let favorites = JSON.parse(localStorage.getItem('urduPromptFavorites')) || [];
            
            // Check if already in favorites
            if (favorites.includes(currentPrompt)) {
                alert('یہ محرک پہلے ہی پسندیدہ میں محفوظ ہے۔');
                return;
            }
            
            favorites.push(currentPrompt);
            localStorage.setItem('urduPromptFavorites', JSON.stringify(favorites));
            
            updateFavoritesList();
            alert('محرک پسندیدہ میں محفوظ ہو گیا ہے۔');
        }

        // Update favorites list in UI
        function updateFavoritesList() {
            const favorites = JSON.parse(localStorage.getItem('urduPromptFavorites')) || [];
            favoritesList.innerHTML = '';
            
            if (favorites.length === 0) {
                favoritesList.innerHTML = '<li>ابھی تک کوئی پسندیدہ محرک محفوظ نہیں کیا گیا۔</li>';
                return;
            }
            
            favorites.forEach((prompt, index) => {
                const li = document.createElement('li');
                li.className = 'favorite-item';
                
                const span = document.createElement('span');
                span.className = 'favorite-text';
                span.textContent = prompt;
                
                const removeBtn = document.createElement('button');
                removeBtn.className = 'remove-btn';
                removeBtn.textContent = 'حذف کریں';
                removeBtn.onclick = () => removeFromFavorites(index);
                
                li.appendChild(span);
                li.appendChild(removeBtn);
                favoritesList.appendChild(li);
            });
        }

        // Remove prompt from favorites
        function removeFromFavorites(index) {
            let favorites = JSON.parse(localStorage.getItem('urduPromptFavorites')) || [];
            favorites.splice(index, 1);
            localStorage.setItem('urduPromptFavorites', JSON.stringify(favorites));
            updateFavoritesList();
        }

        // Copy prompt to clipboard
        function copyPrompt() {
            if (!currentPrompt) {
                alert('براہ کرم پہلے ایک محرک جنریٹ کریں۔');
                return;
            }
            
            navigator.clipboard.writeText(currentPrompt)
                .then(() => {
                    alert('محرک کاپی ہو گیا ہے!');
                })
                .catch(err => {
                    console.error('کاپی کرنے میں خرابی: ', err);
                    alert('محرک کاپی کرنے میں خرابی۔ براہ کرم دوبارہ کوشش کریں۔');
                });
        }

        // Share prompt
        function sharePrompt() {
            if (!currentPrompt) {
                alert('براہ کرم پہلے ایک محرک جنریٹ کریں۔');
                return;
            }
            
            if (navigator.share) {
                navigator.share({
                    title: 'اردو تخلیقی تحریر کا محرک',
                    text: currentPrompt,
                    url: window.location.href
                })
                .then(() => console.log('محرک شیئر کیا گیا'))
                .catch(err => console.error('شیئر کرنے میں خرابی: ', err));
            } else {
                // Fallback for browsers that don't support Web Share API
                copyPrompt();
            }
        }

        // Show download options
        function showDownloadOptions() {
            if (!currentPrompt) {
                alert('براہ کرم پہلے ایک محرک جنریٹ کریں۔');
                return;
            }
            
            downloadOptions.classList.toggle('active');
        }

        // Download as Word document
        function downloadAsWord() {
            if (!currentPrompt) return;
            
            const blob = new Blob([`
                <!DOCTYPE html>
                <html dir="rtl" lang="ur">
                <head>
                    <meta charset="UTF-8">
                    <title>اردو تخلیقی تحریر کا محرک</title>
                    <style>
                        body { 
                            font-family: 'Jameel Noori Nastaleeq', serif; 
                            direction: rtl; 
                            text-align: right; 
                            padding: 40px;
                            line-height: 1.8;
                        }
                        .prompt { 
                            font-size: 24px; 
                            margin-bottom: 30px;
                            border-right: 5px solid #8e44ad;
                            padding-right: 15px;
                        }
                        .info {
                            font-size: 14px;
                            color: #666;
                            margin-top: 40px;
                            border-top: 1px solid #ddd;
                            padding-top: 20px;
                        }
                    </style>
                </head>
                <body>
                    <div class="prompt">${currentPrompt}</div>
                    <div class="info">
                        <p>تخلیق کردہ: MagicRills.com اردو تخلیقی تحریر کا محرک جنریٹر</p>
                        <p>تاریخ: ${new Date().toLocaleDateString('ur-PK')}</p>
                        <p>شعبہ: ${currentArea} | صنف: ${currentCategory} | قسم: ${currentType}</p>
                    </div>
                </body>
                </html>
            `], { type: 'application/msword' });
            
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `urdu_prompt_${Date.now()}.doc`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            downloadOptions.classList.remove('active');
        }

        // Download as PDF
        function downloadAsPDF() {
            if (!currentPrompt) return;
            
            // Using html2canvas and jsPDF
            const { jsPDF } = window.jspdf;
            
            const element = document.createElement('div');
            element.innerHTML = `
                <div style="font-family: 'Jameel Noori Nastaleeq', serif; direction: rtl; text-align: right; padding: 40px; line-height: 1.8;">
                    <div style="font-size: 24px; margin-bottom: 30px; border-right: 5px solid #8e44ad; padding-right: 15px;">${currentPrompt}</div>
                    <div style="font-size: 14px; color: #666; margin-top: 40px; border-top: 1px solid #ddd; padding-top: 20px;">
                        <p>تخلیق کردہ: MagicRills.com اردو تخلیقی تحریر کا محرک جنریٹر</p>
                        <p>تاریخ: ${new Date().toLocaleDateString('ur-PK')}</p>
                        <p>شعبہ: ${currentArea} | صنف: ${currentCategory} | قسم: ${currentType}</p>
                    </div>
                </div>
            `;
            
            document.body.appendChild(element);
            
            html2canvas(element).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jsPDF();
                const imgProps = pdf.getImageProperties(imgData);
                const pdfWidth = pdf.internal.pageSize.getWidth();
                const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
                
                pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
                pdf.save(`urdu_prompt_${Date.now()}.pdf`);
                
                document.body.removeChild(element);
                downloadOptions.classList.remove('active');
            });
        }

        // Toggle dark/light theme
        function toggleTheme() {
            document.body.classList.toggle('dark-theme');
            const isDark = document.body.classList.contains('dark-theme');
            themeToggle.textContent = isDark ? '☀️' : '🌙';
            localStorage.setItem('urduPromptTheme', isDark ? 'dark' : 'light');
        }

        // Update progress bar and steps
        function updateProgress(step) {
            const progressPercentage = (step / 3) * 100;
            progressBar.style.width = `${progressPercentage}%`;
            
            steps.forEach((s, index) => {
                if (index < step) {
                    s.classList.add('active');
                } else {
                    s.classList.remove('active');
                }
            });
        }

        // Reset action buttons
        function resetActionButtons() {
            copyBtn.disabled = true;
            shareBtn.disabled = true;
            saveBtn.disabled = true;
            downloadBtn.disabled = true;
            downloadOptions.classList.remove('active');
        }

        // Initialize theme
        function initTheme() {
            const savedTheme = localStorage.getItem('urduPromptTheme') || 'light';
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-theme');
                themeToggle.textContent = '☀️';
            }
        }

        // Event listeners
        generateBtn.addEventListener('click', generatePrompt);
        saveBtn.addEventListener('click', saveToFavorites);
        copyBtn.addEventListener('click', copyPrompt);
        shareBtn.addEventListener('click', sharePrompt);
        downloadBtn.addEventListener('click', showDownloadOptions);
        downloadWord.addEventListener('click', downloadAsWord);
        downloadPDF.addEventListener('click', downloadAsPDF);
        themeToggle.addEventListener('click', toggleTheme);

        // Initialize
        initTheme();
        updateFavoritesList();
        updateProgress(0);
    </script>
</body>
</html>
